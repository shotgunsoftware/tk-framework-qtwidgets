

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>delegates.view_item_delegate &mdash; tk-framework-qtwidgets v2.12.4 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
    <a href='https://help.autodesk.com/view/SGDEV/ENU/'>
    
        <img style='width: 191px;
                height: 60px;
                margin: 2px;
                border-radius: 0px;
                padding: 0px;'
            src='../../_static/logo@2x.png'/>
    
    </a>
    

          
          
          <a href="../../index.html" class="icon icon-home">
            tk-framework-qtwidgets
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../activity_stream.html">Flow Production Tracking Activity Stream Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../elided_label.html">Auto-Elide label</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../search_completer.html">Flow Production Tracking Search Completers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shotgun_search_widget.html">Flow Production Tracking Search Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../context_widget.html">Context Selector Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../delegates.html">Delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../filtering.html">Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help_screen.html">Help Screen Popup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">Model Related Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../navigation.html">Navigation Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../note_input_widget.html">Flow Production Tracking Note Input Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overlay_widget.html">Text Overlay Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../playback_label.html">Flow Production Tracking Playback Label Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../screen_grab.html">Screen Capture Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shotgun_fields.html">Flow Production Tracking Field Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shotgun_menus.html">Flow Production Tracking Menus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shotgun_widget.html">Flow Production Tracking Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../spinner_widget.html">Spinner Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../version_details.html">Flow Production Tracking Version Details Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../views.html">View Related Classes</a></li>
</ul>


    <a href='genindex.html'>Alphabetic Index</a>

    <div style='margin-top: 50px;
                margin-left: 10px;
                margin-right: 10px;
                padding: 10px;
                color: #b3b3b3;
                font-size: 70%;
                border-radius: 3px;
                background-color: #444;
                line-height: 18px;
                '>
    <style>
        a.custom_post_menu { display: inline;
                             padding: 0px;
                             text-decoration: underline; }
    </style>

    <b>tk-framework-qtwidgets</b> v2.12.4.<br>
    
        This documentation is part of the Flow Production Tracking.
    
    For more information, please visit
    <a class=custom_post_menu href='https://help.autodesk.com/view/SGDEV/ENU/'>The Flow Production Tracking developer portal.</a>.
    The code associated with this documentation can be found
    <a class=custom_post_menu href='https://github.com/shotgunsoftware/tk-framework-qtwidgets'>here</a>.

    </div>
    <style>
        p.privacy_links { margin: 4px 0px;}
    </style>
    <p class="privacy_links"><a data-opt-in-preferences href="javascript:;">Privacy settings</a></p>
    <p class="privacy_links"><a data-wat-linkname="manage-ccpa-settings-footer-link" href="javascript:;">Do not sell my personal information</a></p>
    <p class="privacy_links"><a href="https://www.autodesk.com/company/legal-notices-trademarks/privacy-statement">Privacy/Cookies</a></p>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tk-framework-qtwidgets</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">delegates.view_item_delegate</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for delegates.view_item_delegate</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) 2021 Autodesk, Inc.</span>
<span class="c1">#</span>
<span class="c1"># CONFIDENTIAL AND PROPRIETARY</span>
<span class="c1">#</span>
<span class="c1"># This work is provided &quot;AS IS&quot; and subject to the Shotgun Pipeline Toolkit</span>
<span class="c1"># Source Code License included in this distribution package. See LICENSE.</span>
<span class="c1"># By accessing, using, copying or modifying this work you indicate your</span>
<span class="c1"># agreement to the Shotgun Pipeline Toolkit Source Code License. All rights</span>
<span class="c1"># not expressly granted therein are reserved by Autodesk, Inc.</span>

<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="kn">import</span> <span class="nn">sgtk</span>
<span class="kn">from</span> <span class="nn">sgtk.platform.qt</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">tank.util</span> <span class="kn">import</span> <span class="n">sgre</span> <span class="k">as</span> <span class="n">re</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">tank_vendor</span> <span class="kn">import</span> <span class="n">sgutils</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">tank_vendor</span> <span class="kn">import</span> <span class="n">six</span> <span class="k">as</span> <span class="n">sgutils</span>

<span class="n">utils</span> <span class="o">=</span> <span class="n">sgtk</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">current_bundle</span><span class="p">()</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;utils&quot;</span><span class="p">)</span>

<span class="n">DEBUG_PAINT</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="ViewItemDelegate"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate">[docs]</a><span class="k">class</span> <span class="nc">ViewItemDelegate</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QStyledItemDelegate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A generic delegate to display items in a view.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Positions for actions. Non-floating actions will adjust the content to</span>
    <span class="c1"># fit inline (e.g. not floating on top)</span>
    <span class="n">POSITIONS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;float-top-left&quot;</span><span class="p">,</span>
        <span class="s2">&quot;float-top-right&quot;</span><span class="p">,</span>
        <span class="s2">&quot;float-bottom-left&quot;</span><span class="p">,</span>
        <span class="s2">&quot;float-bottom-right&quot;</span><span class="p">,</span>
        <span class="s2">&quot;float-left&quot;</span><span class="p">,</span>
        <span class="s2">&quot;float-right&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top-left&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top-right&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bottom-left&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bottom-right&quot;</span><span class="p">,</span>
        <span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="s2">&quot;right&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;center&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="c1"># Enum for the POSITIONS</span>
    <span class="p">(</span>
        <span class="n">FLOAT_TOP_LEFT</span><span class="p">,</span>
        <span class="n">FLOAT_TOP_RIGHT</span><span class="p">,</span>
        <span class="n">FLOAT_BOTTOM_LEFT</span><span class="p">,</span>
        <span class="n">FLOAT_BOTTOM_RIGHT</span><span class="p">,</span>
        <span class="n">FLOAT_LEFT</span><span class="p">,</span>
        <span class="n">FLOAT_RIGHT</span><span class="p">,</span>
        <span class="n">TOP_LEFT</span><span class="p">,</span>
        <span class="n">TOP_RIGHT</span><span class="p">,</span>
        <span class="n">BOTTOM_LEFT</span><span class="p">,</span>
        <span class="n">BOTTOM_RIGHT</span><span class="p">,</span>
        <span class="n">LEFT</span><span class="p">,</span>
        <span class="n">RIGHT</span><span class="p">,</span>
        <span class="n">TOP</span><span class="p">,</span>
        <span class="n">BOTTOM</span><span class="p">,</span>
        <span class="n">CENTER</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">POSITIONS</span><span class="p">))</span>

<div class="viewcode-block" id="ViewItemDelegate.Padding"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.Padding">[docs]</a>    <span class="k">class</span> <span class="nc">Padding</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience class structure to store padding values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">left</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Create the Padding object.</span>

<span class="sd">            :param top: The top padding value.</span>
<span class="sd">            :type top: int</span>
<span class="sd">            :param right: The right padding value.</span>
<span class="sd">            :type right: int</span>
<span class="sd">            :param bottom: The bottom padding value.</span>
<span class="sd">            :type bottom: int</span>
<span class="sd">            :param left: The left padding value.</span>
<span class="sd">            :type left: int</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">top</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">right</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">bottom</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">left</span>

<div class="viewcode-block" id="ViewItemDelegate.Padding.new"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.Padding.new">[docs]</a>        <span class="nd">@classmethod</span>
        <span class="k">def</span> <span class="nf">new</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">padding</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Factory method to create a padding object with equal padding all around.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="n">padding</span><span class="p">,</span> <span class="n">padding</span><span class="p">,</span> <span class="n">padding</span><span class="p">)</span></div></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ViewItemDelegate constructor. Sets the default values.</span>

<span class="sd">        :param view: The view that this delegate will be used with.</span>
<span class="sd">        :type view: :class:`sgkt.platform.qt.QtGui.QAbstractItemView`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ViewItemDelegate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>

        <span class="c1"># Store the view widget to fall back on for older versions of Qt, where the QStyleOption does not</span>
        <span class="c1"># have a widget or styleObject property</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_view</span> <span class="o">=</span> <span class="n">view</span>

        <span class="c1"># The item data model roles used to retrieve the item&#39;s data to display. See ViewItemRolesMixin for</span>
        <span class="c1"># more details about the item data roles.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_role</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DecorationRole</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_header_role</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subtitle_role</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_role</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DisplayRole</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_short_text_role</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_icon_role</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expand_role</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width_role</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height_role</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loading_role</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_separator_role</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># The number of visible lines to show (e.g. text will be cut off to this defined number of lines)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_visible_lines</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># The default qss to apply to the text document style sheet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_document_style_sheet</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># Turn on text eliding, if False, text will be wrapped</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elide_text</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elide_header</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Fix the item&#39;s width and height. These will be ignored if set to None. When set to -1, these will</span>
        <span class="c1"># expand to the full available space.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_width</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># The minimum width and height for the item rect. These will essentially be ignored if less than 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_min_width</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_min_height</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># Fix the item&#39;s thumbnail size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_size</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">()</span>
        <span class="c1"># Set this value to scale the thumbnail size as the item height changes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_scale_value</span> <span class="o">=</span> <span class="mf">1.5</span>
        <span class="c1"># Set to True to scale thumbnails to fill the entire thumbnail rect available. This</span>
        <span class="c1"># will result in thumbnails drawn in uniform manner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_uniform</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Positioning of the thumbnail withint the available thumbnail rect. Empty tuple will default</span>
        <span class="c1"># to center the the thumbnail.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_position</span> <span class="o">=</span> <span class="p">()</span>
        <span class="c1"># The extent used to convert a QIcon to QPixmap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pixmap_extent</span> <span class="o">=</span> <span class="mi">512</span>
        <span class="c1"># The size used for icons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_icon_size</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
        <span class="c1"># This is the percentage value used to calculate the maximum badge icon height (e.g. badge</span>
        <span class="c1"># icon is rendered over a rect, if that rect height is 100 and the `badge_height_pct` is 0.5,</span>
        <span class="c1"># then the badge icon maximum height will be 50). Note that badge icons will only be scaled</span>
        <span class="c1"># down to fit, not scaled up if the icon size is smaller than the max height.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_badge_height_pct</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span>

        <span class="c1"># Button padding and margin values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action_item_margin</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_button_padding</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="c1"># Text document margin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_document_margin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Padding around the whole item rect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Padding</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Padding</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Padding</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Text alignment (TOP | BOTTOM | CENTER). NOTE this aligns the text within the text bounding rect,</span>
        <span class="c1"># meaning that the text block will be aligned within the available text area, but text itself will</span>
        <span class="c1"># remain left-aligned. To implement aligning the text itself, a custom QTextDocumentLayout class</span>
        <span class="c1"># is required. There is another limitation to text horizontal alignment when there is a header</span>
        <span class="c1"># and/or subtitle present; horizontal alignment will have no effect since the header and subtitle</span>
        <span class="c1"># cause the text block to span the full available text bounding rect width.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_rect_halign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LEFT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_rect_valign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TOP</span>

        <span class="c1"># Font to set on the QTextDocument. If None, the font from the QStyleOptionViewItem will be used.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_font</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Radius values for rounding item and thumbnail rects.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_x_radius</span> <span class="o">=</span> <span class="mf">4.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_y_radius</span> <span class="o">=</span> <span class="mf">4.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_x_radius</span> <span class="o">=</span> <span class="mf">4.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_y_radius</span> <span class="o">=</span> <span class="mf">4.0</span>

        <span class="c1"># The pen used to draw the thumbnail (add a border around the pixmap rect).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_pen</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span>
        <span class="c1"># The pen used to paint the background (the background brush is customized through the model data</span>
        <span class="c1"># role BackgroundRole). The pen is responsible for rendering a border around the item rect.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_pen</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span>
        <span class="c1"># The brush and pen used to draw the loading indicator.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loading_pen</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loading_brush</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
        <span class="c1"># The brush used to paint the selection. The palette highlight brush will be used if not set.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selection_brush</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># The brush used to paint the item separator, if there is one.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_separator_brush</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span>

        <span class="c1"># Enable painting selection on hover</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_hover_selection</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Enable showing tooltips when text is clipped</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_text_tooltip</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Override the QStandardItem object toolitp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_override_item_tooltip</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Values used to draw the animated loading image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seconds_per_spin</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_spin_arc_len</span> <span class="o">=</span> <span class="mi">300</span>

        <span class="c1"># The actions for the item</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># The cursor shape that will be set when the current cursor is hovering over a &quot;clickable&quot; thing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action_hover_cursor</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">thumbnail_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data &#39;thumbnail&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        This role is used to retrieve the view item thumbnail; e.g. thumbnail = index.idata(thumbnail_role).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_role</span>

    <span class="nd">@thumbnail_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">thumbnail_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">header_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data &#39;title&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        This role is used to retrieve the view item title text; e.g. text = index.data(header_role).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_role</span>

    <span class="nd">@header_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">header_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_header_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">subtitle_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data &#39;subtitle&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        This role is used to retrieve the view item subtitle text; e.g. text = index.data(subtitle_role).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subtitle_role</span>

    <span class="nd">@subtitle_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">subtitle_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subtitle_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">text_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data &#39;text&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        This role is used to retrieve the view item main text; e.g. text = index.data(text_role).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_role</span>

    <span class="nd">@text_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">text_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">short_text_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`). This</span>
<span class="sd">        role is used to retrieve the view item shortened text; e.g. text = index.data(short_text_role).</span>
<span class="sd">        The view item shortened text may be useful for thumbnail items that do not display well with</span>
<span class="sd">        longer text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_short_text_role</span>

    <span class="nd">@short_text_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">short_text_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_short_text_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">icon_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data &#39;icon&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        This role is used to retrieve the view item icons; e.g. icons = index.data(icon_role). Icons are</span>
<span class="sd">        optional images that can be displayed on the item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_icon_role</span>

    <span class="nd">@icon_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">icon_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_icon_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data item &#39;width&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width_role</span>

    <span class="nd">@width_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">width_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">height_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data item &#39;height&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height_role</span>

    <span class="nd">@height_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">height_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">expand_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data item &#39;expand&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        When this role is set, it will allow item rows to expand and collapse based on the text height.</span>
<span class="sd">        The index.data model does not need to do any additional work to enable this functionality, aside</span>
<span class="sd">        from providing a role for the delegate to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_role</span>

    <span class="nd">@expand_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">expand_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expand_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">loading_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data &#39;loading&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        The  data for this role will determine if a loading icon will be drawn for the view item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loading_role</span>

    <span class="nd">@loading_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">loading_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loading_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">separator_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the index model data &#39;separator&#39; role (:class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`).</span>
<span class="sd">        The data for this role will determine if a separator will be drawn for the view item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_separator_role</span>

    <span class="nd">@separator_role</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">separator_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_separator_role</span> <span class="o">=</span> <span class="n">role</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">visible_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the number of text lines the view item should display. This will omit any text that</span>
<span class="sd">        is beyond the number of visible lines.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visible_lines</span>

    <span class="nd">@visible_lines</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">visible_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_visible_lines</span> <span class="o">=</span> <span class="n">lines</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">document_style_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the default qss for the text document style sheet. This will affect the text style and layout of the item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_document_style_sheet</span>

    <span class="nd">@document_style_sheet</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">document_style_sheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qss</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_document_style_sheet</span> <span class="o">=</span> <span class="n">qss</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">elide_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the flag indicating if the main text should be elided. If False, text will be wrapped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elide_text</span>

    <span class="nd">@elide_text</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">elide_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elide_text</span> <span class="o">=</span> <span class="n">on</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">elide_header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the flag indicating if the header text should be elided. If False, text will be wrapped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elide_header</span>

    <span class="nd">@elide_header</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">elide_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elide_header</span> <span class="o">=</span> <span class="n">on</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">item_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the view item width. Set to None to ignore this property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_width</span>

    <span class="nd">@item_width</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">item_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_width</span> <span class="o">=</span> <span class="n">width</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">item_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the view item row height. If -1, this property is ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_height</span>

    <span class="nd">@item_height</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">item_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_height</span> <span class="o">=</span> <span class="n">height</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_scale_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_height</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">):</span>
            <span class="c1"># Scale the thumbnail width as the row height changes.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_height</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_scale_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">min_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the minimum width for an item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_width</span>

    <span class="nd">@min_width</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">min_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_min_width</span> <span class="o">=</span> <span class="n">width</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">min_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the minimum height for an item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_height</span>

    <span class="nd">@min_height</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">min_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_min_height</span> <span class="o">=</span> <span class="n">height</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">thumbnail_uniform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the property that affects how thumbnails are rendered.</span>

<span class="sd">        True will draw all thumbnails in a uniform manner. Thumbnails will fill the avialable</span>
<span class="sd">        space, but may be cropped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_uniform</span>

    <span class="nd">@thumbnail_uniform</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">thumbnail_uniform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uniform</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_uniform</span> <span class="o">=</span> <span class="n">uniform</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">thumbnail_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the preferred size for the view item thumbnail. The value will be used to</span>
<span class="sd">        render the thumbnail, but the size of the thumbnail is not guaranteed to be the exact</span>
<span class="sd">        `thumbnail_size`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_size</span>

    <span class="nd">@thumbnail_size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">thumbnail_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_size</span> <span class="o">=</span> <span class="n">size</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">thumbnail_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the preferred thumbnail width. Convenience property to set the width of the</span>
<span class="sd">        `thumbnail_size` property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_size</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>

    <span class="nd">@thumbnail_width</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">thumbnail_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_size</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">thumbnail_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the preferred thumbnail height. Convenience property to set the height of the</span>
<span class="sd">        `thumbnail_size` property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>

    <span class="nd">@thumbnail_height</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">thumbnail_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_size</span><span class="o">.</span><span class="n">setHeight</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pixmap_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the extent used when converting :class:`sgtk.platform.qt.QtGui.QIcon` to a</span>
<span class="sd">        :class:`sgkt.platformqt.QtGui.QPixmap`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pixmap_extent</span>

    <span class="nd">@pixmap_extent</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">pixmap_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extent</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pixmap_extent</span> <span class="o">=</span> <span class="n">extent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">icon_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the icon size for the view item action icons.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_icon_size</span>

    <span class="nd">@icon_size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">icon_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_icon_size</span> <span class="o">=</span> <span class="n">size</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">badge_height_pct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the percentage value used to calculate the maximum badge icon height (e.g. badge</span>
<span class="sd">        icon is rendered over a rect, if that rect height is 100 and the `badge_height_pct` is 0.5,</span>
<span class="sd">        then the badge icon maximum height will be 50). Note that badge icons will only be scaled</span>
<span class="sd">        down to fit, not scaled up if the icon size is smaller than the max height.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_badge_height_pct</span>

    <span class="nd">@badge_height_pct</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">badge_height_pct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pct</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_badge_height_pct</span> <span class="o">=</span> <span class="n">pct</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">action_item_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the margin used for buttons.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action_item_margin</span>

    <span class="nd">@action_item_margin</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">action_item_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action_item_margin</span> <span class="o">=</span> <span class="n">margin</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">button_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the padding used for buttons.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_button_padding</span>

    <span class="nd">@button_padding</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">button_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">padding</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_button_padding</span> <span class="o">=</span> <span class="n">padding</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">text_document_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the margin for the view item text. A :class:`sgtk.platform.qt.QtGui.QTextDocument` is used to</span>
<span class="sd">        render the view item text, this value will be used to set the QTextDocument margin property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_document_margin</span>

    <span class="nd">@text_document_margin</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">text_document_margin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_document_margin</span> <span class="o">=</span> <span class="n">margin</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">item_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the view item padding. This value will add padding to the view item rect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_padding</span>

    <span class="nd">@item_padding</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">item_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">padding</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_padding</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Padding</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_item_padding</span> <span class="o">=</span> <span class="n">padding</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_item_padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Padding</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid padding value </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">padding</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">thumbnail_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the padding for the item thumbnail.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_padding</span>

    <span class="nd">@thumbnail_padding</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">thumbnail_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">padding</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_padding</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Padding</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_padding</span> <span class="o">=</span> <span class="n">padding</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Padding</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid padding value </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">padding</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">text_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the padding for the item text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_padding</span>

    <span class="nd">@text_padding</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">text_padding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">padding</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_padding</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Padding</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_padding</span> <span class="o">=</span> <span class="n">padding</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_text_padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Padding</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">padding</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid padding value </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">padding</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">text_rect_halign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the text block horizontal alignment. This aligns the text block, not the text lines themselves (e.g. the</span>
<span class="sd">        block of text will be aligned within the available space, but the text lines will remain aligned left). Horizontal</span>
<span class="sd">        alignment will have no effect if there is a header and/or subtitle present (this causes the text block to expand</span>
<span class="sd">        to the full available width).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_rect_halign</span>

    <span class="nd">@text_rect_halign</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">text_rect_halign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alignment</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">alignment</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CENTER</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Text horizontal alignment &#39;</span><span class="si">{align}</span><span class="s2">&#39; not supported. Must be one of &#39;LEFT&#39;, &#39;RIGHT, &#39;CENTER&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">align</span><span class="o">=</span><span class="n">alignment</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_rect_halign</span> <span class="o">=</span> <span class="n">alignment</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">text_rect_valign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the text block vertical alignment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_rect_valign</span>

    <span class="nd">@text_rect_valign</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">text_rect_valign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alignment</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">alignment</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TOP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">CENTER</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Text vertical alignment &#39;</span><span class="si">{align}</span><span class="s2">&#39; not supported. Must be one of &#39;TOP&#39;, &#39;BOTTOM, &#39;CENTER&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">align</span><span class="o">=</span><span class="n">alignment</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_text_rect_valign</span> <span class="o">=</span> <span class="n">alignment</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">font</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the font used to render the item text. If not specified, the QStyleOptionViewItem font value</span>
<span class="sd">        will be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_font</span>

    <span class="nd">@font</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_font</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">background_pen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the :class:`sgtk.platform.qt.QGui.QPen` pen used to draw the view item background.</span>
<span class="sd">        Setting this value will add a border around the view item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background_pen</span>

    <span class="nd">@background_pen</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">background_pen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background_pen</span> <span class="o">=</span> <span class="n">pen</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">loading_pen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the :class:`sgtk.platform.qt.QtGui.QPen` pen used to draw the item loading indicator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loading_pen</span>

    <span class="nd">@loading_pen</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">loading_pen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pen</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loading_pen</span> <span class="o">=</span> <span class="n">pen</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">loading_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the :class:`sgtk.platform.qt.QtGui.QBrush` brush used to paint the background of the item</span>
<span class="sd">        loading rect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loading_brush</span>

    <span class="nd">@loading_brush</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">loading_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brush</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loading_brush</span> <span class="o">=</span> <span class="n">brush</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">selection_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the :class:`sgtk.platform.qt.QGui.QBrush` used to draw the view item selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selection_brush</span>

    <span class="nd">@selection_brush</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">selection_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brush</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selection_brush</span> <span class="o">=</span> <span class="n">brush</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">separator_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the :class:`sgtk.platform.qt.QGui.QBrush` used to draw the view item separator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_separator_brush</span>

    <span class="nd">@separator_brush</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">separator_brush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brush</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_separator_brush</span> <span class="o">=</span> <span class="n">brush</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">show_hover_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the flag indicating to draw selection on hover or not. The default is set to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_hover_selection</span>

    <span class="nd">@show_hover_selection</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">show_hover_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_hover_selection</span> <span class="o">=</span> <span class="n">show</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">show_text_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the flag indicating to show a tooltip if the item text has been elided.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_text_tooltip</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">override_item_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the flag indicating to override the tooltip set on the QStandardItem object. Note that</span>
<span class="sd">        this will only affect indexes that have an associated QStandardItem (e.g. the index model derives</span>
<span class="sd">        from the QStandardItemModel class).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_override_item_tooltip</span>

    <span class="nd">@override_item_tooltip</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">override_item_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">override</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_override_item_tooltip</span> <span class="o">=</span> <span class="n">override</span>

    <span class="nd">@show_text_tooltip</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">show_text_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_text_tooltip</span> <span class="o">=</span> <span class="n">show</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">action_hover_cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or set the cursor :class:`sgtk.platform.qt.QtGui.QCursor` for when an action button is</span>
<span class="sd">        hovered over.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action_hover_cursor</span>

    <span class="nd">@action_hover_cursor</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">action_hover_cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_action_hover_cursor</span> <span class="o">=</span> <span class="n">cursor</span>

<div class="viewcode-block" id="ViewItemDelegate.get_option_background_brush"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.get_option_background_brush">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_option_background_brush</span><span class="p">(</span><span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the background brush for the QStyleOptionviewItem object.</span>

<span class="sd">        NOTE: This method should be used to retrieve the QStyleOptionViewItem&#39;s</span>
<span class="sd">        backgroundBrush property. For different version of Qt, the backgroundBrush</span>
<span class="sd">        property may not exist.</span>

<span class="sd">        :param option: The option to get the background brush from.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>

<span class="sd">        :return: The option&#39;s background brush object.</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtGui.QBrush`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">option</span><span class="o">.</span><span class="n">backgroundBrush</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">brush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Background</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewItemDelegate.is_selected"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.is_selected">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_selected</span><span class="p">(</span><span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if the item is selected.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>

<span class="sd">        :return: True if the item is selected, else False.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_Selected</span></div>

<div class="viewcode-block" id="ViewItemDelegate.get_value"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.get_value">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the index.data for the given role. If the data returned is</span>
<span class="sd">        a function, return the value of the executing the function.</span>

<span class="sd">        :param role: The item data role</span>
<span class="sd">        :type role: :class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`</span>

<span class="sd">        :return: The value for the index and role. If the value found is None,</span>
<span class="sd">                 the default_value will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">role</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">role</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="c1"># If the data itself is a function, execute the function to get the data value.</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default_value</span>

        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="ViewItemDelegate.get_display_values_list"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.get_display_values_list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_display_values_list</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">join_char</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of display string values. Each return item in the list</span>
<span class="sd">        represents a text line.</span>

<span class="sd">        :param role: The item data role</span>
<span class="sd">        :type role: :class:`sgtk.platform.qt.QtCore.Qt.ItemDataRole`</span>
<span class="sd">        :param flat: If True, the value returned will be the list of values joined</span>
<span class="sd">                     by the &#39;join_char&#39; (default join char is &quot;&quot;)</span>
<span class="sd">        :type flat: bool</span>
<span class="sd">        :param join_char: Used to join the list of values to return a single value, when</span>
<span class="sd">                          `flat` is True.</span>
<span class="sd">        :type join_char: str</span>

<span class="sd">        :return: A list of display values. An empty list is returned if no data</span>
<span class="sd">                is found, or was unable to parse the data for the index&#39;s role.</span>
<span class="sd">        :rtype: list&lt;str&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">ViewItemDelegate</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">role</span><span class="p">)</span>
        <span class="n">values_list</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">values_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">values_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="c1"># Special PTR string formatting data</span>
                <span class="n">values_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">utils</span><span class="o">.</span><span class="n">convert_token_string</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">values_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">values_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&lt;b&gt;</span><span class="si">%s</span><span class="s2">&lt;/b&gt;:  </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">values_list</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Ensure items in values_list are strings</span>
            <span class="n">values_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">flat</span><span class="p">:</span>
            <span class="c1"># Return the values listed flattened</span>
            <span class="k">if</span> <span class="n">join_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">join_char</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">return</span> <span class="n">join_char</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">values_list</span><span class="p">)</span>

        <span class="c1"># Return the values list</span>
        <span class="k">return</span> <span class="n">values_list</span></div>

<div class="viewcode-block" id="ViewItemDelegate.split_html_lines"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.split_html_lines">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">split_html_lines</span><span class="p">(</span><span class="n">html_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to split html text by line break tags.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&lt;br\s*/?&gt;&quot;</span><span class="p">,</span> <span class="n">html_text</span><span class="p">)</span></div>

    <span class="c1">######################################################################################################</span>
    <span class="c1"># Public methods</span>

<div class="viewcode-block" id="ViewItemDelegate.is_hover"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.is_hover">[docs]</a>    <span class="k">def</span> <span class="nf">is_hover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if the mouse is over the item. This will always return</span>
<span class="sd">        False if the option does not have a widget or the option&#39;s widget</span>
<span class="sd">        does not have mouse tracking enabeld.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>

<span class="sd">        :return: True if the mouse is over the item, else False.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_mouse_tracking</span><span class="p">(</span><span class="n">option</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_MouseOver</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ViewItemDelegate.has_mouse_tracking"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.has_mouse_tracking">[docs]</a>    <span class="k">def</span> <span class="nf">has_mouse_tracking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if the item&#39;s option widget has mouse tracking enabled.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>

<span class="sd">        :return: True if the item has mouse tracking enabled.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">widget</span> <span class="ow">and</span> <span class="n">widget</span><span class="o">.</span><span class="n">hasMouseTracking</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewItemDelegate.get_cursor_pos"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.get_cursor_pos">[docs]</a>    <span class="k">def</span> <span class="nf">get_cursor_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the mouse cursor position relative to the item&#39;s widget. This</span>
<span class="sd">        will always return False if the option&#39;s widget does not have</span>
<span class="sd">        mouse tracking enabled.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>

<span class="sd">        :return: The cursor position relative to the option widget.</span>
<span class="sd">        :rtype: :class:`sgkt.platform.qt.QtCore.QPoint`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_mouse_tracking</span><span class="p">(</span><span class="n">option</span><span class="p">):</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">widget</span><span class="o">.</span><span class="n">mapFromGlobal</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="ViewItemDelegate.get_option_widget"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.get_option_widget">[docs]</a>    <span class="k">def</span> <span class="nf">get_option_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the widget for the QStyleOptionviewItem object.</span>

<span class="sd">        NOTE: This method should be used to retrieve the QStyleOptionViewItem&#39;s widget property.</span>
<span class="sd">        For different version of Qt, the widget is stored in different properties.</span>

<span class="sd">        :param option: The option to get the widget from.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>

<span class="sd">        :return: The option&#39;s widget object.</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtGui.QWidget`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">widget</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">widget</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">widget</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">styleObject</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="c1"># Fall back to the delegate&#39;s view</span>
                <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_view</span>

        <span class="k">return</span> <span class="n">widget</span></div>

<div class="viewcode-block" id="ViewItemDelegate.add_actions"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.add_actions">[docs]</a>    <span class="k">def</span> <span class="nf">add_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">FLOAT_BOTTOM_RIGHT</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add actions that will be made available to show for each item. This method should be used to</span>
<span class="sd">        add actions to the `_actions` field instead of editing it directly.</span>

<span class="sd">        :param actions: The actions to add.</span>
<span class="sd">        :type actions: list&lt;dict&gt;, where each dict represents the action. The dict will be passed to</span>
<span class="sd">                       the ViewItemAction constructor to create a ViewItemAction object.</span>
<span class="sd">        :param position: The position to display the actions.</span>
<span class="sd">        :type position: POSITION enum, defaults to float on the bottom right of the item rect.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">item_action</span> <span class="o">=</span> <span class="n">ViewItemAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item_action</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewItemDelegate.add_action"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.add_action">[docs]</a>    <span class="k">def</span> <span class="nf">add_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">FLOAT_BOTTOM_RIGHT</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to add an action. See `add_actions`.</span>

<span class="sd">        :param actions: The actions to add.</span>
<span class="sd">        :type actions: list&lt;dict&gt;, where each dict represents the action. The dict will be passed to</span>
<span class="sd">                       the ViewItemAction constructor to create a ViewItemAction object.</span>
<span class="sd">        :param position: The position to display the actions.</span>
<span class="sd">        :type position: POSITION enum, defaults to float on the bottom right of the item rect.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_actions</span><span class="p">([</span><span class="n">action</span><span class="p">],</span> <span class="n">position</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewItemDelegate.remove_actions"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.remove_actions">[docs]</a>    <span class="k">def</span> <span class="nf">remove_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the actions at the specified position. If positions are not specified, remove</span>
<span class="sd">        all actions.</span>

<span class="sd">        :param positions: The list of positions to remove actions from.</span>
<span class="sd">        :type positions: list&lt;POSITION&gt;, where POSITION is one of the POSITIONS enum.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">positions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="p">[</span><span class="n">position</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="ViewItemDelegate.scale_thumbnail_to_item_height"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.scale_thumbnail_to_item_height">[docs]</a>    <span class="k">def</span> <span class="nf">scale_thumbnail_to_item_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale_value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If scale_value is not None, the thumbnail width will scale with the row height by a factor</span>
<span class="sd">        of `scale_value` (e.g. thumbnail_width = item_height * scale_value). This is convenient when</span>
<span class="sd">        the item size is adjusted dynmaically (e.g. using a slider) and this will scale up and down</span>
<span class="sd">        the thumbnail with the item size.</span>

<span class="sd">        :param scale_value: The value to scale the thumbnail by.</span>
<span class="sd">        :type scale_value: float</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_scale_value</span> <span class="o">=</span> <span class="n">scale_value</span></div>

<div class="viewcode-block" id="ViewItemDelegate.get_displayed_text"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.get_displayed_text">[docs]</a>    <span class="k">def</span> <span class="nf">get_displayed_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the text that is displayed for the item. The text will be plain (not rich HTML).</span>
<span class="sd">        This may be useful for filtering items displayed by this delegate, since the model data</span>
<span class="sd">        may be formatted by the delegate before being displayed.</span>

<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create dummy view options and rect, in order to get the text.</span>
        <span class="n">dummy_option</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionViewItem</span><span class="p">()</span>
        <span class="n">dummy_rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">doc</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_document</span><span class="p">(</span><span class="n">dummy_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">dummy_rect</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span></div>

    <span class="c1">###############################################################################################</span>
    <span class="c1"># Override :class:`sgtk.platform.qt.QtGui.QStyledItemDelegate` methods</span>

<div class="viewcode-block" id="ViewItemDelegate.initStyleOption"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.initStyleOption">[docs]</a>    <span class="k">def</span> <span class="nf">initStyleOption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides :class:`sgtk.platform.qt.QtGui.QStyledItemDelegate` method.</span>

<span class="sd">        Initialize the option used for rendering the item. This should be called before using</span>
<span class="sd">        the option (e.g. sizeHint, paint, etc.).</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Adjust the option rect to account for padding around the view item content.</span>
        <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">adjust</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item_padding</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item_padding</span><span class="o">.</span><span class="n">top</span><span class="p">,</span>
            <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">item_padding</span><span class="o">.</span><span class="n">right</span><span class="p">,</span>
            <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">item_padding</span><span class="o">.</span><span class="n">bottom</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ViewItemDelegate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initStyleOption</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewItemDelegate.createEditor"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.createEditor">[docs]</a>    <span class="k">def</span> <span class="nf">createEditor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides :class:`sgtk.platform.qt.QtGui.QStyledItemDelegate` method.</span>

<span class="sd">        This default implementation does not provide an editor.</span>

<span class="sd">        :param parent: The editor&#39;s parent widget.</span>
<span class="sd">        :type parent: :class:`sgtk.platform.qt.QtGui.QWidget`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :return: The editor widget for the item.</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtGui.QWidget`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="ViewItemDelegate.editorEvent"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.editorEvent">[docs]</a>    <span class="k">def</span> <span class="nf">editorEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides :class:`sgtk.platform.qt.QtGui.QStyledItemDelegate` method.</span>

<span class="sd">        Listens for left mouse button press events to check if a view item action</span>
<span class="sd">        should be triggered.</span>

<span class="sd">        If mouse tracking has been enabled on the option&#39;s widget, this method</span>
<span class="sd">        will listens and act on mouse move events, even if there is no editor</span>
<span class="sd">        set up for the item.</span>

<span class="sd">        :param event: The event that triggered the editing. Mouse events are sent to</span>
<span class="sd">                      this method even if they do not start editing the item.</span>
<span class="sd">        :type event: :class:`sgtk.platform.qt.QtCore.QEvent`</span>
<span class="sd">        :param model: The model of the item.</span>
<span class="sd">        :type model: :class:`sgtk.platform.qt.QtCore.QAbstractItemModel`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :return: True if the event was handled, else False (it was ignored).</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Initialize the view option</span>
        <span class="n">view_option</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionViewItem</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initStyleOption</span><span class="p">(</span><span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">MouseButtonPress</span>
            <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span>
        <span class="p">):</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action_at</span><span class="p">(</span><span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">action</span> <span class="ow">and</span> <span class="n">action</span><span class="o">.</span><span class="n">is_clickable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">index</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span>
                    <span class="c1"># Trigger the action callback function if the action defines one</span>
                    <span class="n">action</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">index</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>

                <span class="k">elif</span> <span class="n">action</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">ViewItemAction</span><span class="o">.</span><span class="n">checkable_types</span><span class="p">():</span>
                    <span class="c1"># The default behaviour for checkable actions is to set the index check state role data;</span>
                    <span class="c1"># however, this only works if there is a single checkable action for the index, or else</span>
                    <span class="c1"># each checkable action will modify the same data role property. For multiple checkable</span>
                    <span class="c1"># actions for an index (item), callbacks for each action need to be defined.</span>
                    <span class="n">check_state_role</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">check_state_role</span>
                    <span class="k">if</span> <span class="n">index</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">check_state_role</span><span class="p">)</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">:</span>
                        <span class="n">new_check_state</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">new_check_state</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span>
                    <span class="n">index</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_check_state</span><span class="p">,</span> <span class="n">check_state_role</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Action is clickable but has no callback to execute&quot;</span>

                <span class="c1"># Return True to incate the event has been handled.</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">MouseMove</span><span class="p">:</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">view_option</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_hover_cursor</span> <span class="ow">and</span> <span class="n">widget</span><span class="p">:</span>
                <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_action_at</span><span class="p">(</span><span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">pos</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">action</span> <span class="ow">and</span> <span class="n">action</span><span class="o">.</span><span class="n">is_clickable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">index</span><span class="p">):</span>
                    <span class="c1"># Set the cursor to indicate the action is clickable</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action_hover_cursor</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">unsetCursor</span><span class="p">()</span>

            <span class="c1"># Fall through to allow the base implementation to perform any other mouse move event handling</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ViewItemDelegate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">editorEvent</span><span class="p">(</span>
            <span class="n">event</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ViewItemDelegate.sizeHint"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.sizeHint">[docs]</a>    <span class="k">def</span> <span class="nf">sizeHint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides :class:`sgtk.platform.qt.QtGui.QStyledItemDelegate` method.</span>

<span class="sd">        Returns the size hint for the view item.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">()</span>

        <span class="c1"># Initialize the view option</span>
        <span class="n">view_option</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionViewItem</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initStyleOption</span><span class="p">(</span><span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

        <span class="c1"># Default width and height to -1, indicating no size hint and that the item width/height</span>
        <span class="c1"># should expand to the full available space.</span>
        <span class="n">width</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">height</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># Calculate the width of the item.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># The width is fixed for all items.</span>
            <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_width</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Set the width to the value defined by the index data.</span>
            <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_role</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Default to the option rect width if not set</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>

        <span class="c1"># For valid width values, ensure it is the minumum width and add padding.</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_width</span><span class="p">)</span>

        <span class="c1"># Calculate the height of the item. First, get the height of the text. Check if the</span>
        <span class="c1"># height should expand to fit the text or not.</span>
        <span class="n">text_height</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">index_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height_role</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item_height</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_height</span> <span class="o">&lt;</span> <span class="mi">0</span>
            <span class="ow">or</span> <span class="n">index_height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_role</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">index_height</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">index_height</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># The item height expands to the height of the text. NOTE the view that this delegate is</span>
                <span class="c1"># set to must not have uniform items set for this to resize properly.</span>
                <span class="n">text_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_rect</span><span class="p">(</span><span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
                <span class="n">text_doc</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_document</span><span class="p">(</span>
                    <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
                <span class="n">doc_height</span> <span class="o">=</span> <span class="n">text_doc</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
                <span class="n">height_for_visible_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_visible_lines_height</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">index_height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Height should be max of the calculated text height, or the delegate fixed item height</span>
                    <span class="n">item_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_height</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">text_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">doc_height</span><span class="p">,</span> <span class="n">height_for_visible_lines</span><span class="p">,</span> <span class="n">item_height</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Do not allow delegate item height to override text height for index, when set.</span>
                    <span class="n">text_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">doc_height</span><span class="p">,</span> <span class="n">height_for_visible_lines</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">index_height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Set the height the value defined by the index data.</span>
                <span class="n">text_height</span> <span class="o">=</span> <span class="n">index_height</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Fix the text height</span>
            <span class="n">text_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_height</span>

        <span class="c1"># Add padding to the text height, if there is text</span>
        <span class="k">if</span> <span class="n">text_height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">text_height</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_padding</span><span class="o">.</span><span class="n">top</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_padding</span><span class="o">.</span><span class="n">bottom</span>

        <span class="c1"># Get the height of the item thumbnail</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_height</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_thumbnail</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">thumbnail_height</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_height</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_padding</span><span class="o">.</span><span class="n">top</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_padding</span><span class="o">.</span><span class="n">bottom</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thumbnail_height</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># Get the height of the item actions</span>
        <span class="n">actions_height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_actions_maximum_height</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

        <span class="c1"># The height is determined by the maximum height required for any of the item components</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">text_height</span><span class="p">,</span> <span class="n">thumbnail_height</span><span class="p">,</span> <span class="n">actions_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_height</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_padding</span><span class="o">.</span><span class="n">top</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_padding</span><span class="o">.</span><span class="n">bottom</span>

        <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span></div>

<div class="viewcode-block" id="ViewItemDelegate.paint"><a class="viewcode-back" href="../../delegates.html#delegates.ViewItemDelegate.paint">[docs]</a>    <span class="k">def</span> <span class="nf">paint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overrides :class:`sgtk.platform.qt.QtGui.QStyledItemDelegate` method.</span>

<span class="sd">        The main paint method that draws each item in the view. Override specific draw</span>
<span class="sd">        methods to customize the rendered item, if needed.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="c1"># Initialize the view option</span>
        <span class="n">view_option</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionViewItem</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initStyleOption</span><span class="p">(</span><span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="c1"># The styleObject propety is cleared by initStyleOption, but for Qt versions &lt; 5.12 the</span>
        <span class="c1"># styleObject is required since that is where the option&#39;s widget is stored (instead of</span>
        <span class="c1"># option.widget property as in Qt &gt;= 5.12), so we will just reset the styleObject back</span>
        <span class="c1"># to the incoming options&#39; styleObject value.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">view_option</span><span class="o">.</span><span class="n">styleObject</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">styleObject</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="c1"># Fall back to use the view as the style object for Qt versions where QStyleOption</span>
            <span class="c1"># does not have a widget or styleObject property.</span>
            <span class="n">view_option</span><span class="o">.</span><span class="n">styleObject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_view</span>

        <span class="c1"># Check if the index should be expanded or collapsed, and update the index</span>
        <span class="c1"># model data to render the correct row height for the index.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_index_expand_state</span><span class="p">(</span><span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setRenderHints</span><span class="p">(</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="o">.</span><span class="n">Antialiasing</span> <span class="o">|</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPainter</span><span class="o">.</span><span class="n">TextAntialiasing</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_background</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">)</span>
        <span class="n">thumbnail_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draw_thumbnail</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_text</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_actions</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_separator</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_selected</span><span class="p">(</span><span class="n">view_option</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_hover_selection</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_hover</span><span class="p">(</span><span class="n">view_option</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_draw_selection</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_icon_badges</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">thumbnail_rect</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_loading</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">DEBUG_PAINT</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">magenta</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">cyan</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">view_option</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span></div>

    <span class="c1">######################################################################################################</span>
    <span class="c1"># Draw Methods</span>
    <span class="c1"># Override any of these draw methods to customize how that particular aspect of the item is rendered.</span>

    <span class="k">def</span> <span class="nf">_draw_background</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the view item background. This default implementation will fill the option rect using the</span>
<span class="sd">        option background brush. Modify the option background brush by returning a</span>
<span class="sd">        :class:`sgtk.platform.qt.QtGui.QBrush` for index.data role `sgtk.platform.qt.QtCore.Qt.BackgroundRole`.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_option_background_brush</span><span class="p">(</span><span class="n">option</span><span class="p">)))</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">background_pen</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawRoundedRect</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_x_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_y_radius</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_draw_loading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the animated loading indicator. This default implementation will render an arc rotating</span>
<span class="sd">        in a circle for as long as the item data indicates that the item is in a loading state.</span>

<span class="sd">        The formula used to render the spinning loader is borrowed from the :class:`SpinnerWidget`.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_loading_rect</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rect</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loading_brush</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loading_brush</span> <span class="o">!=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span><span class="p">:</span>
            <span class="c1"># Paint the background while loading.</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_loading_brush</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawRoundedRect</span><span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_x_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_y_radius</span>
            <span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

        <span class="c1"># Calculate spin angle as a function of time so that all spinners appear in sync</span>
        <span class="c1"># This uses the same function as the SpinnerWidget</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">s</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seconds_per_spin</span>
        <span class="n">start_angle</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mi">360</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seconds_per_spin</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_pen</span><span class="p">:</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_pen</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
            <span class="n">color</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">foregroundRole</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">widget</span>
                <span class="k">else</span> <span class="n">option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">pen</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawArc</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="o">-</span><span class="n">start_angle</span> <span class="o">*</span> <span class="mi">16</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spin_arc_len</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">DEBUG_PAINT</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">magenta</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_draw_separator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw a line to separate this view item from the next. This default implementation will</span>
<span class="sd">        render a line from the bottom left corner to the bottom right, in the same color used</span>
<span class="sd">        by the option palette foreground, if available, or the option widget text color.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator_role</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">separator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator_role</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">separator</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># TODO support decorations in the separator (e.g. icon or text with the horizontal line)</span>
        <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">POSITIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">separator</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">position</span> <span class="o">=</span> <span class="n">separator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">separator_brush</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span><span class="p">:</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
            <span class="n">color</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">foregroundRole</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">widget</span>
                <span class="k">else</span> <span class="n">option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="n">pen</span><span class="o">.</span><span class="n">setWidthF</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">separator_brush</span><span class="o">.</span><span class="n">color</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">position</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">POSITIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">TOP</span><span class="p">]:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">topLeft</span><span class="p">()</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">topRight</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Draw the line from the bottom left corner to bottom right</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottomLeft</span><span class="p">()</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottomRight</span><span class="p">()</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_separator_brush</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawLine</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_draw_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the view item selection. This default implementation will draw a border around</span>
<span class="sd">        the item rect and a translucent background, in the color the the option palette</span>
<span class="sd">        highlight color.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_brush</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span><span class="p">:</span>
            <span class="n">brush</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_brush</span><span class="p">:</span>
            <span class="n">brush</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_brush</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">)</span>
            <span class="n">pen</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">highlight</span><span class="p">()</span><span class="o">.</span><span class="n">color</span><span class="p">())</span>
            <span class="n">pen</span><span class="o">.</span><span class="n">setWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">fill_color</span> <span class="o">=</span> <span class="n">pen</span><span class="o">.</span><span class="n">color</span><span class="p">()</span>
            <span class="n">fill_color</span><span class="o">.</span><span class="n">setAlpha</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">brush</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">fill_color</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">pen</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">brush</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawRoundedRect</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_x_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_item_y_radius</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_draw_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the view item thumbnail. This default implementation will scale the thumbnail width</span>
<span class="sd">        and height down to the thumbnail rect size, if larger, keeping the aspect ratio. The</span>
<span class="sd">        thumbnail will also be centered within the calculated thumbnail rect.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_thumbnail</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">thumbnail</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">()</span>

        <span class="c1"># Get the available rect to draw the thumbnail</span>
        <span class="n">available_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_thumbnail_rect</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">thumbnail</span><span class="p">)</span>
        <span class="n">available_size</span> <span class="o">=</span> <span class="n">available_rect</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">thumbnail_rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="n">available_rect</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_uniform</span><span class="p">:</span>
            <span class="c1"># Scale the thumbnail to fill the available space. The thumbnail size may be</span>
            <span class="c1"># bigger than the available space. If it is, the thumbnail will be cropped</span>
            <span class="c1"># later to center the thumbnail within the available rect.</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">scaled</span><span class="p">(</span>
                <span class="n">available_size</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span>
                <span class="n">available_size</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">KeepAspectRatioByExpanding</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">SmoothTransformation</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Scale the thumbnail to fit the available space.</span>
            <span class="k">if</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">available_size</span><span class="o">.</span><span class="n">height</span><span class="p">():</span>
                <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span><span class="n">available_size</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">available_size</span><span class="o">.</span><span class="n">width</span><span class="p">():</span>
                <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">scaledToWidth</span><span class="p">(</span><span class="n">available_size</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
            <span class="c1"># Set the thumbnail rect to the size of the thumbnail after scaling</span>
            <span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">setSize</span><span class="p">(</span><span class="n">thumbnail</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>

        <span class="c1"># Adjust the thumbnail and the rect used to draw the thumbnail such that the thumbnail</span>
        <span class="c1"># fits and is centered within the draw rect</span>
        <span class="n">thumbnail_width</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="n">thumbnail_height</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="n">available_width</span> <span class="o">=</span> <span class="n">available_size</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="n">available_height</span> <span class="o">=</span> <span class="n">available_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">thumbnail_width</span> <span class="o">&lt;</span> <span class="n">available_width</span><span class="p">:</span>
            <span class="c1"># Calculate horizontal offset to move the thumbnail rect</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">LEFT</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_position</span><span class="p">:</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">RIGHT</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_position</span><span class="p">:</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="n">available_width</span> <span class="o">-</span> <span class="n">thumbnail_width</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Default to center horizontally</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">available_width</span> <span class="o">-</span> <span class="n">thumbnail_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">thumbnail_width</span> <span class="o">&gt;</span> <span class="n">available_width</span><span class="p">:</span>
            <span class="c1"># Calculate the horizontal offset to crop the thumbnail</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">thumbnail_width</span> <span class="o">-</span> <span class="n">available_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">thumbnail_height</span> <span class="o">&lt;</span> <span class="n">available_height</span><span class="p">:</span>
            <span class="c1"># Calculate vertical offset to move the thumbnail rect</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TOP</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_position</span><span class="p">:</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOTTOM</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_position</span><span class="p">:</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="n">available_height</span> <span class="o">-</span> <span class="n">thumbnail_height</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Default to center vertically</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">available_height</span> <span class="o">-</span> <span class="n">thumbnail_height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">thumbnail_height</span> <span class="o">&gt;</span> <span class="n">available_height</span><span class="p">:</span>
            <span class="c1"># Calculate the vertical offset to crop the thumbnail</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">thumbnail_height</span> <span class="o">-</span> <span class="n">available_height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># Adjust the rect to be centered</span>
        <span class="n">top_left</span> <span class="o">=</span> <span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">topLeft</span><span class="p">()</span>
        <span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">top_left</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">top_left</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)</span>

        <span class="c1"># Adjust the thumbnail to be centered within the rect</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">or</span> <span class="n">y</span><span class="p">:</span>
            <span class="n">crop_rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">available_width</span><span class="p">,</span> <span class="n">available_height</span><span class="p">)</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">crop_rect</span><span class="p">)</span>

        <span class="c1"># Create a brush with the thumbnail as a texture, so that the painter can draw the pixmap</span>
        <span class="c1"># as a rounded rect.</span>
        <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">thumbnail</span><span class="p">)</span>

        <span class="c1"># Draw the pixmap</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_pen</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">topLeft</span><span class="p">())</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawRoundedRect</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span>
            <span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_x_radius</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_y_radius</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">DEBUG_PAINT</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">topLeft</span><span class="p">())</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">yellow</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawRoundedRect</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span>
                <span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_x_radius</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_thumbnail_y_radius</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">thumbnail_rect</span>

    <span class="k">def</span> <span class="nf">_draw_icon_badges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">bounding_rect</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the badges for this index item. This method supports drawing up to four</span>
<span class="sd">        badges, one is each corner of the given `bounding_rect`.</span>

<span class="sd">        The index.data describes the badges to draw; the data is expected to be</span>
<span class="sd">        a single :class:`sgtk.platform.qt.QtGui.QPixmap` or a dict with possible keys-values:</span>
<span class="sd">            {</span>
<span class="sd">                &quot;[float-]top-left&quot;: :class:`sgtk.platform.qt.QtGui.QPixmap`,</span>
<span class="sd">                &quot;[float-]top-right&quot;: :class:`sgtk.platform.qt.QtGui.QPixmap`,</span>
<span class="sd">                &quot;[float-]bottom-left&quot;: :class:`sgtk.platform.qt.QtGui.QPixmap`,</span>
<span class="sd">                &quot;[float-]bottom-right&quot;: :class:`sgtk.platform.qt.QtGui.QPixmap`,</span>
<span class="sd">            }</span>
<span class="sd">        Floating and non-floating position keys accepted; however all icons will be drawn</span>
<span class="sd">        in a &quot;floating&quot; orientation.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param bounding_rect: The rect that the badge icons will be overlayed.</span>
<span class="sd">        :type bounding_rect: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Default to the option rect if the giving bounding rect is invalid</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bounding_rect</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="n">bounding_rect</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">rect</span>

        <span class="n">badge_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_role</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">badge_data</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">badge_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># Default to bottom right if only a pixmap given for badge data.</span>
            <span class="n">badge_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bottom-right&quot;</span><span class="p">:</span> <span class="n">badge_data</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">position</span><span class="p">,</span> <span class="n">pixmap_data</span> <span class="ow">in</span> <span class="n">badge_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pixmap_data</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># The pixmap to display for the icon badge</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># Inset will display the badge inside the bounding rect, otherwise the badge</span>
            <span class="c1"># will be display centered over the corner corresponding to the badge position.</span>
            <span class="n">inset</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pixmap_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">pixmap_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pixmap&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">inset</span> <span class="o">=</span> <span class="n">pixmap_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;inset&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">pixmap_data</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pixmap</span><span class="p">,</span> <span class="s2">&quot;pixmap&quot;</span><span class="p">):</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_icon_to_pixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pixmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">pixmap</span><span class="p">:</span>
                <span class="c1"># Skip, invalid pixmap data.</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">badge_height_pct</span>
                <span class="ow">and</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">badge_height_pct</span>
            <span class="p">):</span>
                <span class="c1"># Scale the pixmap to fit neatly into a corner</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span>
                    <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">badge_height_pct</span>
                <span class="p">)</span>

            <span class="n">pixmap_size</span> <span class="o">=</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">POSITIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">POSITIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">FLOAT_TOP_LEFT</span><span class="p">],</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="n">inset</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                        <span class="n">bounding_rect</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_padding</span><span class="p">,</span>
                        <span class="n">bounding_rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_padding</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">bounding_rect</span><span class="o">.</span><span class="n">topLeft</span><span class="p">()</span>
                    <span class="n">point</span> <span class="o">+=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                        <span class="o">-</span><span class="n">pixmap_size</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                        <span class="o">-</span><span class="n">pixmap_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="k">elif</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">POSITIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">POSITIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">FLOAT_TOP_RIGHT</span><span class="p">],</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="n">inset</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                        <span class="n">bounding_rect</span><span class="o">.</span><span class="n">right</span><span class="p">()</span>
                        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_padding</span>
                        <span class="o">-</span> <span class="n">pixmap_size</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span>
                        <span class="n">bounding_rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_padding</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">bounding_rect</span><span class="o">.</span><span class="n">topRight</span><span class="p">()</span>
                    <span class="n">point</span> <span class="o">+=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                        <span class="o">-</span><span class="n">pixmap_size</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                        <span class="o">-</span><span class="n">pixmap_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">POSITIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">POSITIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">FLOAT_BOTTOM_LEFT</span><span class="p">],</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="n">inset</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                        <span class="n">bounding_rect</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_padding</span><span class="p">,</span>
                        <span class="n">bounding_rect</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span>
                        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_padding</span>
                        <span class="o">-</span> <span class="n">pixmap_size</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">bounding_rect</span><span class="o">.</span><span class="n">bottomLeft</span><span class="p">()</span>
                    <span class="n">point</span> <span class="o">+=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                        <span class="o">-</span><span class="n">pixmap_size</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                        <span class="o">-</span><span class="n">pixmap_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Default to bottom right corner.</span>
                <span class="k">if</span> <span class="n">inset</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                        <span class="n">bounding_rect</span><span class="o">.</span><span class="n">right</span><span class="p">()</span>
                        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_padding</span>
                        <span class="o">-</span> <span class="n">pixmap_size</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span>
                        <span class="n">bounding_rect</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span>
                        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_padding</span>
                        <span class="o">-</span> <span class="n">pixmap_size</span><span class="o">.</span><span class="n">height</span><span class="p">(),</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="n">bounding_rect</span><span class="o">.</span><span class="n">bottomRight</span><span class="p">()</span>
                    <span class="n">point</span> <span class="o">+=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                        <span class="o">-</span><span class="n">pixmap_size</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                        <span class="o">-</span><span class="n">pixmap_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="n">badge_rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">pixmap</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawPixmap</span><span class="p">(</span><span class="n">badge_rect</span><span class="p">,</span> <span class="n">pixmap</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_draw_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the view item text. This will get the whole text document and use the QTextDocument</span>
<span class="sd">        method `drawContents` to render the text, in order to handle HTML/rich text.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_rect</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rect</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">doc</span><span class="p">,</span> <span class="n">elided</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_document</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>

        <span class="c1"># Vertical text alignment</span>
        <span class="n">text_height</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="n">available_height</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">text_height</span> <span class="o">&lt;</span> <span class="n">available_height</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_rect_valign</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CENTER</span><span class="p">:</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">available_height</span> <span class="o">-</span> <span class="n">text_height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_rect_valign</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">:</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="n">available_height</span> <span class="o">-</span> <span class="n">text_height</span>

        <span class="c1"># Horizontal text alignment</span>
        <span class="n">text_width</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">idealWidth</span><span class="p">()</span>
        <span class="n">available_width</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">text_width</span> <span class="o">&lt;</span> <span class="n">available_width</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_rect_halign</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CENTER</span><span class="p">:</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">available_width</span> <span class="o">-</span> <span class="n">text_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_rect_halign</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="n">available_width</span> <span class="o">-</span> <span class="n">text_width</span>

        <span class="c1"># Get the point to translate the painter, before drawing the text.</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)</span>

        <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">drawContents</span><span class="p">(</span><span class="n">painter</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">DEBUG_PAINT</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoBrush</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">red</span><span class="p">))</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

        <span class="c1"># Draw the text tooltip. Check if text is elided here, since we&#39;ve arleady did</span>
        <span class="c1"># some work to check for text eliding.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">elided</span><span class="p">:</span>
            <span class="c1"># FIXME we need to specifically check the header if it was elided, as this does not</span>
            <span class="c1"># get caught in the main `_get_text_document` method.</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">elided</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_header_text</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">return_elided</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_text_tooltip</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">elided</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_draw_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Paint the actions for the view item. Actions are rendered using the option</span>
<span class="sd">        widget&#39;s QStyle (or defaults to the application QStyle) as passing in QStyleOptionButton</span>
<span class="sd">        options to specifiy how the action button should be displayed.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param view_option: The option used for rendering the item.</span>
<span class="sd">        :type view_option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get the list of available actions for this item, and their corresponding boudning rect.</span>
        <span class="n">actions_and_rects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_action_and_rects</span><span class="p">(</span><span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">actions_and_rects</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">action</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">rect</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
                <span class="k">continue</span>

            <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">view_option</span><span class="o">.</span><span class="n">font</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">action</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ViewItemAction</span><span class="o">.</span><span class="n">TYPE_PUSH_BUTTON</span>
                <span class="ow">or</span> <span class="n">action</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ViewItemAction</span><span class="o">.</span><span class="n">TYPE_ICON</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_draw_action_push_button</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">action</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ViewItemAction</span><span class="o">.</span><span class="n">TYPE_RADIO_BUTTON</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_draw_action_radio_button</span><span class="p">(</span>
                    <span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">action</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ViewItemAction</span><span class="o">.</span><span class="n">TYPE_CHECK_BOX</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_draw_action_check_box</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">action</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">ViewItemAction</span><span class="o">.</span><span class="n">TYPE_PROGRESS_BAR</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_draw_action_progress_bar</span><span class="p">(</span>
                    <span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span>
                <span class="p">)</span>

            <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">DEBUG_PAINT</span><span class="p">:</span>
                <span class="n">painter</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
                <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">cyan</span><span class="p">))</span>
                <span class="n">painter</span><span class="o">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
                <span class="n">painter</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_draw_action_push_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the action as a push button.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param view_option: The option used for rendering the item.</span>
<span class="sd">        :type view_option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item to render.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param action: The action to draw the push button for</span>
<span class="sd">        :type action: ViewItemAction</span>
<span class="sd">        :param rect: The action&#39;s bounding rect</span>
<span class="sd">        :type rect: QRect</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_data</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="c1"># Do not draw actions that are not visible or are placeholders</span>
            <span class="k">return</span>

        <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">view_option</span><span class="p">)</span>
        <span class="n">button_option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_action_button_option</span><span class="p">(</span>
            <span class="n">view_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index_data</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_push_button</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">button_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">button_option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_MouseOver</span><span class="p">:</span>
            <span class="n">tooltip</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">tooltip</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tooltip</span><span class="p">:</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span>
                    <span class="mi">500</span><span class="p">,</span>
                    <span class="k">lambda</span> <span class="n">o</span><span class="o">=</span><span class="n">view_option</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">rect</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">tooltip</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draw_tooltip</span><span class="p">(</span>
                        <span class="n">o</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span>
                    <span class="p">),</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_draw_action_radio_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the action as a radio button.</span>

<span class="sd">        To draw a &quot;checked&quot; radio button, the state must include the flag QtGui.QStyle.State_On.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param view_option: The option used for rendering the item.</span>
<span class="sd">        :type view_option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item to render.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param action: The action to draw the push button for</span>
<span class="sd">        :type action: ViewItemAction</span>
<span class="sd">        :param rect: The action&#39;s bounding rect</span>
<span class="sd">        :type rect: QRect</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_data</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="c1"># Do not draw actions that are not visible or are placeholders</span>
            <span class="k">return</span>

        <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">view_option</span><span class="p">)</span>
        <span class="n">button_option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_action_button_option</span><span class="p">(</span>
            <span class="n">view_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index_data</span>
        <span class="p">)</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">style</span><span class="p">()</span> <span class="k">if</span> <span class="n">widget</span> <span class="k">else</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">style</span><span class="p">()</span>

        <span class="n">style</span><span class="o">.</span><span class="n">proxy</span><span class="p">()</span><span class="o">.</span><span class="n">drawControl</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">CE_RadioButton</span><span class="p">,</span> <span class="n">button_option</span><span class="p">,</span> <span class="n">painter</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">button_option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_MouseOver</span><span class="p">:</span>
            <span class="n">tooltip</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">tooltip</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tooltip</span><span class="p">:</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span>
                    <span class="mi">500</span><span class="p">,</span>
                    <span class="k">lambda</span> <span class="n">o</span><span class="o">=</span><span class="n">view_option</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">rect</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">tooltip</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draw_tooltip</span><span class="p">(</span>
                        <span class="n">o</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span>
                    <span class="p">),</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_draw_action_check_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the action as a check box.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param view_option: The option used for rendering the item.</span>
<span class="sd">        :type view_option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item to render.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param action: The action to draw the push button for</span>
<span class="sd">        :type action: ViewItemAction</span>
<span class="sd">        :param rect: The action&#39;s bounding rect</span>
<span class="sd">        :type rect: QRect</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_data</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="c1"># Do not draw actions that are not visible or are placeholders</span>
            <span class="k">return</span>

        <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">view_option</span><span class="p">)</span>
        <span class="n">button_option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_action_button_option</span><span class="p">(</span>
            <span class="n">view_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index_data</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">button_option</span><span class="o">.</span><span class="n">icon</span><span class="p">:</span>
            <span class="c1"># Checkbox is displayed using an icon, draw it as a flat button</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_draw_push_button</span><span class="p">(</span><span class="n">painter</span><span class="p">,</span> <span class="n">button_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">style</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">style</span><span class="p">()</span> <span class="k">if</span> <span class="n">widget</span> <span class="k">else</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">style</span><span class="p">()</span>
            <span class="n">style</span><span class="o">.</span><span class="n">proxy</span><span class="p">()</span><span class="o">.</span><span class="n">drawControl</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">CE_CheckBox</span><span class="p">,</span> <span class="n">button_option</span><span class="p">,</span> <span class="n">painter</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">button_option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_MouseOver</span><span class="p">:</span>
            <span class="n">tooltip</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">tooltip</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tooltip</span><span class="p">:</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span>
                    <span class="mi">500</span><span class="p">,</span>
                    <span class="k">lambda</span> <span class="n">o</span><span class="o">=</span><span class="n">view_option</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">rect</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">tooltip</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draw_tooltip</span><span class="p">(</span>
                        <span class="n">o</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span>
                    <span class="p">),</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_draw_action_progress_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the action as a progress bar.</span>

<span class="sd">        :param painter: the object used for painting.</span>
<span class="sd">        :type painter: :class:`sgkt.platform.qt.QtGui.QPainter`</span>
<span class="sd">        :param view_option: The option used for rendering the item.</span>
<span class="sd">        :type view_option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item to render.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param action: The action to draw the push button for</span>
<span class="sd">        :type action: ViewItemAction</span>
<span class="sd">        :param rect: The action&#39;s bounding rect</span>
<span class="sd">        :type rect: QRect</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_data</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="c1"># Do not draw actions that are not visible or are placeholders</span>
            <span class="k">return</span>

        <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">view_option</span><span class="p">)</span>
        <span class="n">progress_bar_option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_action_progress_bar_option</span><span class="p">(</span>
            <span class="n">view_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index_data</span>
        <span class="p">)</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">style</span><span class="p">()</span> <span class="k">if</span> <span class="n">widget</span> <span class="k">else</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">style</span><span class="p">()</span>

        <span class="n">style</span><span class="o">.</span><span class="n">proxy</span><span class="p">()</span><span class="o">.</span><span class="n">drawControl</span><span class="p">(</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">CE_ProgressBar</span><span class="p">,</span> <span class="n">progress_bar_option</span><span class="p">,</span> <span class="n">painter</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">progress_bar_option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_MouseOver</span><span class="p">:</span>
            <span class="n">tooltip</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">tooltip</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tooltip</span><span class="p">:</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span>
                    <span class="mi">500</span><span class="p">,</span>
                    <span class="k">lambda</span> <span class="n">o</span><span class="o">=</span><span class="n">view_option</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">rect</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">tooltip</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draw_tooltip</span><span class="p">(</span>
                        <span class="n">o</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span>
                    <span class="p">),</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_draw_push_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">painter</span><span class="p">,</span> <span class="n">button_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw a push button.</span>

<span class="sd">        Ideally calling QStyle.drawControl method with QStyle.CE_PushButton could render the push button, but</span>
<span class="sd">        there are issues with certain styles, so the QCommonStyle drawControl method is reimplemented with</span>
<span class="sd">        some special handling.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">style</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">style</span><span class="p">()</span> <span class="k">if</span> <span class="n">widget</span> <span class="k">else</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">style</span><span class="p">()</span>

        <span class="n">is_flat</span> <span class="o">=</span> <span class="n">button_option</span><span class="o">.</span><span class="n">features</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionButton</span><span class="o">.</span><span class="n">Flat</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_flat</span><span class="p">:</span>
            <span class="n">style</span><span class="o">.</span><span class="n">proxy</span><span class="p">()</span><span class="o">.</span><span class="n">drawControl</span><span class="p">(</span>
                <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">CE_PushButtonBevel</span><span class="p">,</span> <span class="n">button_option</span><span class="p">,</span> <span class="n">painter</span>
            <span class="p">)</span>

        <span class="n">subopt</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionButton</span><span class="p">(</span><span class="n">button_option</span><span class="p">)</span>
        <span class="n">subopt</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">subElementRect</span><span class="p">(</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">SE_PushButtonContents</span><span class="p">,</span> <span class="n">button_option</span><span class="p">,</span> <span class="n">widget</span>
        <span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">proxy</span><span class="p">()</span><span class="o">.</span><span class="n">drawControl</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">CE_PushButtonLabel</span><span class="p">,</span> <span class="n">subopt</span><span class="p">,</span> <span class="n">painter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">button_option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_HasFocus</span><span class="p">:</span>
            <span class="n">fropt</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionFocusRect</span><span class="p">()</span>
            <span class="n">fropt</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_background_brush</span><span class="p">(</span>
                <span class="n">button_option</span>
            <span class="p">)</span><span class="o">.</span><span class="n">color</span><span class="p">()</span>
            <span class="n">fropt</span><span class="o">.</span><span class="n">palette</span> <span class="o">=</span> <span class="n">button_option</span><span class="o">.</span><span class="n">palette</span>
            <span class="n">fropt</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">button_option</span><span class="o">.</span><span class="n">state</span>
            <span class="n">fropt</span><span class="o">.</span><span class="n">fontMetrics</span> <span class="o">=</span> <span class="n">button_option</span><span class="o">.</span><span class="n">fontMetrics</span>
            <span class="n">fropt</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="n">style</span><span class="o">.</span><span class="n">subElementRect</span><span class="p">(</span>
                <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">SE_PushButtonFocusRect</span><span class="p">,</span> <span class="n">button_option</span><span class="p">,</span> <span class="n">widget</span>
            <span class="p">)</span>
            <span class="n">style</span><span class="o">.</span><span class="n">proxy</span><span class="p">()</span><span class="o">.</span><span class="n">drawPrimitive</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">PE_FrameFocusRect</span><span class="p">,</span> <span class="n">fropt</span><span class="p">,</span> <span class="n">painter</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init_style_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">style_option</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index_data</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the style option to render the index action.</span>

<span class="sd">        :param style_option: The style option used for rendering the item. This will be specific to the</span>
<span class="sd">            element to be drawn (e.g. QStyleOptionButton, QStyleOptionProgressBar, etc.).</span>
<span class="sd">        :type style_option: :class:`sgtk.platform.qt.QtGui.QStyleOption`</span>
<span class="sd">        :param view_option: The option used for rendering the item.</span>
<span class="sd">        :type view_option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param widget: Set this widget for the style option to inherit the style from.</span>
<span class="sd">        :type widget: QtGui.QWidget</span>
<span class="sd">        :param action: The action to draw the push button for</span>
<span class="sd">        :type action: ViewItemAction</span>
<span class="sd">        :param rect: The action&#39;s bounding rect</span>
<span class="sd">        :type rect: QRect</span>
<span class="sd">        :param index_data: The specifici data for the action and the index being rendered</span>
<span class="sd">        :type index_data: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">widget</span><span class="p">:</span>
            <span class="n">style_option</span><span class="o">.</span><span class="n">initFrom</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>

        <span class="n">style_option</span><span class="o">.</span><span class="n">fontMetrics</span> <span class="o">=</span> <span class="n">view_option</span><span class="o">.</span><span class="n">fontMetrics</span>
        <span class="n">style_option</span><span class="o">.</span><span class="n">palette</span> <span class="o">=</span> <span class="n">view_option</span><span class="o">.</span><span class="n">palette</span>
        <span class="n">style_option</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="n">rect</span>
        <span class="n">style_option</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_Active</span> <span class="o">|</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_Enabled</span>
        <span class="p">)</span>

        <span class="c1"># Add the hover state, if the current cursor position intersects the action rect.</span>
        <span class="n">is_hover</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hit_box_test</span><span class="p">(</span><span class="n">view_option</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_hover</span><span class="p">:</span>
            <span class="n">style_option</span><span class="o">.</span><span class="n">state</span> <span class="o">|=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_MouseOver</span>

        <span class="c1"># TODO find a better way to specifiy the palette color based on button state.</span>
        <span class="c1"># e.g. is there a way leverage the palette color group and roles?</span>
        <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">palette_brushes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_hover</span><span class="p">:</span>
                <span class="n">brushes</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">palette_brushes</span><span class="p">[</span><span class="s2">&quot;hover&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">brushes</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">palette_brushes</span><span class="p">[</span><span class="s2">&quot;active&quot;</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">color_group</span><span class="p">,</span> <span class="n">color_role</span><span class="p">,</span> <span class="n">brush</span> <span class="ow">in</span> <span class="n">brushes</span><span class="p">:</span>
                <span class="n">style_option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">color_group</span><span class="p">,</span> <span class="n">color_role</span><span class="p">,</span> <span class="n">brush</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_action_progress_bar_option</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index_data</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the progress bar style option to render the index action.</span>

<span class="sd">        :param style_option: The style option used for rendering the item. This will be specific to the</span>
<span class="sd">            element to be drawn (e.g. QStyleOptionButton, QStyleOptionProgressBar, etc.).</span>
<span class="sd">        :type style_option: :class:`sgtk.platform.qt.QtGui.QStyleOption`</span>
<span class="sd">        :param view_option: The option used for rendering the item.</span>
<span class="sd">        :type view_option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param widget: Set this widget for the style option to inherit the style from.</span>
<span class="sd">        :type widget: QtGui.QWidget</span>
<span class="sd">        :param action: The action to draw the push button for</span>
<span class="sd">        :type action: ViewItemAction</span>
<span class="sd">        :param rect: The action&#39;s bounding rect</span>
<span class="sd">        :type rect: QRect</span>
<span class="sd">        :param index_data: The specifici data for the action and the index being rendered</span>
<span class="sd">        :type index_data: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">progress_bar_option</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionProgressBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_style_option</span><span class="p">(</span>
            <span class="n">progress_bar_option</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index_data</span>
        <span class="p">)</span>

        <span class="n">progress_bar_option</span><span class="o">.</span><span class="n">minimum</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;minimum&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">progress_bar_option</span><span class="o">.</span><span class="n">maximum</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;maximum&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">progress_bar_option</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;progress&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">progress_bar_option</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">progress_bar_option</span><span class="o">.</span><span class="n">textVisible</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text_visible&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">progress_bar_option</span><span class="o">.</span><span class="n">textAlignment</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;text_alignment&quot;</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span>
        <span class="p">)</span>
        <span class="n">progress_bar_option</span><span class="o">.</span><span class="n">bottomToTop</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bottom_to_top&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">progress_bar_option</span><span class="o">.</span><span class="n">invertedAppearance</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;inverted_appearance&quot;</span><span class="p">,</span> <span class="kc">False</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">progress_bar_option</span>

    <span class="k">def</span> <span class="nf">_get_action_button_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the button style option to render the index action.</span>

<span class="sd">        :param style_option: The style option used for rendering the item. This will be specific to the</span>
<span class="sd">            element to be drawn (e.g. QStyleOptionButton, QStyleOptionProgressBar, etc.).</span>
<span class="sd">        :type style_option: :class:`sgtk.platform.qt.QtGui.QStyleOption`</span>
<span class="sd">        :param view_option: The option used for rendering the item.</span>
<span class="sd">        :type view_option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param widget: Set this widget for the style option to inherit the style from.</span>
<span class="sd">        :type widget: QtGui.QWidget</span>
<span class="sd">        :param action: The action to draw the push button for</span>
<span class="sd">        :type action: ViewItemAction</span>
<span class="sd">        :param rect: The action&#39;s bounding rect</span>
<span class="sd">        :type rect: QRect</span>
<span class="sd">        :param index_data: The specifici data for the action and the index being rendered</span>
<span class="sd">        :type index_data: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">button_option</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionButton</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_style_option</span><span class="p">(</span>
            <span class="n">button_option</span><span class="p">,</span> <span class="n">view_option</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index_data</span>
        <span class="p">)</span>

        <span class="n">button_option</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="c1"># Set the action icon</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;icon&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">icon</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">icon</span><span class="p">:</span>
            <span class="n">icon_size</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;icon_size&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">action</span><span class="o">.</span><span class="n">icon_size</span>
            <span class="n">button_option</span><span class="o">.</span><span class="n">icon</span> <span class="o">=</span> <span class="n">icon</span>
            <span class="n">button_option</span><span class="o">.</span><span class="n">iconSize</span> <span class="o">=</span> <span class="n">icon_size</span>

        <span class="c1"># Apply any additional features defined by the action.</span>
        <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
            <span class="n">button_option</span><span class="o">.</span><span class="n">features</span> <span class="o">|=</span> <span class="n">action</span><span class="o">.</span><span class="n">features</span>

        <span class="c1"># Icons and checkboxes are rendered as flat buttons</span>
        <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ViewItemAction</span><span class="o">.</span><span class="n">TYPE_ICON</span><span class="p">,</span> <span class="n">ViewItemAction</span><span class="o">.</span><span class="n">TYPE_CHECK_BOX</span><span class="p">):</span>
            <span class="n">button_option</span><span class="o">.</span><span class="n">features</span> <span class="o">|=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionButton</span><span class="o">.</span><span class="n">Flat</span>

        <span class="c1"># Override palette to invert text color for flat buttons it have a higher contrast</span>
        <span class="k">if</span> <span class="n">button_option</span><span class="o">.</span><span class="n">features</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyleOptionButton</span><span class="o">.</span><span class="n">Flat</span><span class="p">:</span>
            <span class="n">is_hover</span> <span class="o">=</span> <span class="n">button_option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_MouseOver</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_hover</span> <span class="ow">or</span> <span class="n">action</span><span class="o">.</span><span class="n">callback</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">brush</span> <span class="o">=</span> <span class="n">button_option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">light</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">brush</span> <span class="o">=</span> <span class="n">button_option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">buttonText</span><span class="p">()</span>
            <span class="n">button_option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">ButtonText</span><span class="p">,</span> <span class="n">brush</span><span class="p">)</span>
            <span class="n">button_option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">Window</span><span class="p">,</span> <span class="n">brush</span><span class="p">)</span>

        <span class="c1"># Override the palette for disabled buttons</span>
        <span class="c1"># This is a work aroudn because the QStyle draw methods do not seem to render the</span>
        <span class="c1"># &quot;disabled&quot; state for the button, even when the palette &quot;Disabled&quot; color group is set</span>
        <span class="k">if</span> <span class="n">button_option</span><span class="o">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_Enabled</span><span class="p">:</span>
            <span class="c1"># Button enabled - leave the palette as is</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Button disabled - set the button and button text brushes to render a &#39;greyed out&#39; look</span>
            <span class="n">disabledButtonText</span> <span class="o">=</span> <span class="n">button_option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">buttonText</span><span class="p">()</span>
            <span class="n">disabledButtonTextColor</span> <span class="o">=</span> <span class="n">disabledButtonText</span><span class="o">.</span><span class="n">color</span><span class="p">()</span>
            <span class="n">disabledButtonTextColor</span><span class="o">.</span><span class="n">setAlpha</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
            <span class="n">disabledButtonText</span><span class="o">.</span><span class="n">setColor</span><span class="p">(</span><span class="n">disabledButtonTextColor</span><span class="p">)</span>
            <span class="n">button_option</span><span class="o">.</span><span class="n">palette</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span>
                <span class="n">QtGui</span><span class="o">.</span><span class="n">QPalette</span><span class="o">.</span><span class="n">ButtonText</span><span class="p">,</span> <span class="n">disabledButtonText</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">button_option</span>

    <span class="k">def</span> <span class="nf">_draw_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show a tooltip at the current cursor position, if it is hovering over the given rect.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param rect: The rect to check if the cursor is over.</span>
<span class="sd">        :type rect: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        :param text: The tooltip text to display.</span>
<span class="sd">        :type text: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cursor_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cursor_pos</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_option_widget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cursor_pos</span> <span class="ow">and</span> <span class="n">rect</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_pos</span><span class="p">):</span>
            <span class="n">global_pos</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">()</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QToolTip</span><span class="o">.</span><span class="n">showText</span><span class="p">(</span><span class="n">global_pos</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_draw_text_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">elided</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show a tooltip for the item&#39;s text if it has been elided or clipped. Text tooltips will</span>
<span class="sd">        only be drawn if:</span>
<span class="sd">            1. The `show_text_tooltip` property is True</span>
<span class="sd">            2. The `override_item_tooltip` property is True or the item does not have a tooltip</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param rect: The rect to check if the cursor is over.</span>
<span class="sd">        :type rect: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param elided: True if the text has already been processed and is elided, else False. If</span>
<span class="sd">                       set to None, the text has not been processed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Only show tooltips if enabled and the cursor is hovering</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_text_tooltip</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_hover</span><span class="p">(</span><span class="n">option</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Try to get the item associated with this index, to check if it has a tooltip set.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="o">.</span><span class="n">model</span><span class="p">(),</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QSortFilterProxyModel</span><span class="p">):</span>
                <span class="n">source_index</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">mapToSource</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">source_index</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">itemFromIndex</span><span class="p">(</span><span class="n">source_index</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">itemFromIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="n">item_tooltip</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">toolTip</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="c1"># Failed to extract the tooltip from the index .</span>
            <span class="n">item</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">item_tooltip</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_override_item_tooltip</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">item_tooltip</span><span class="p">:</span>
            <span class="c1"># Tooltip override was set or the item does not have a tooltip, so show our tooltip</span>
            <span class="c1"># with the full text if it was elided, or clipped and auto-expand is disabled.</span>

            <span class="k">if</span> <span class="n">elided</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Text has not yet been processed for eliding, let&#39;s check here.</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">elided</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_document</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">elided</span><span class="p">:</span>
                    <span class="c1"># FIXME header eliding is not detected in the _get_text_document method</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">elided</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_header_text</span><span class="p">(</span>
                        <span class="n">index</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">return_elided</span><span class="o">=</span><span class="kc">True</span>
                    <span class="p">)</span>

            <span class="n">clipped</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">elided</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_role</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Auto-expand disabled, check if text clipped.</span>
                <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="n">clipped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_text_clipped</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">elided</span> <span class="ow">or</span> <span class="n">clipped</span><span class="p">:</span>
                <span class="c1"># Override the item tooltip by clearing it before showing the tooltip we want.</span>
                <span class="k">if</span> <span class="n">item</span> <span class="ow">and</span> <span class="n">item_tooltip</span><span class="p">:</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

                <span class="c1"># Show plain text in the tooltip, remove any trailing white space and ensure single line spacing.</span>
                <span class="n">full_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_displayed_text</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="o">.</span><span class="n">singleShot</span><span class="p">(</span>
                    <span class="mi">500</span><span class="p">,</span>
                    <span class="k">lambda</span> <span class="n">o</span><span class="o">=</span><span class="n">option</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">rect</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">full_text</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_draw_tooltip</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>
                <span class="p">)</span>

    <span class="c1">######################################################################################################</span>
    <span class="c1"># Getter methods to retrieve the item data to display. Override any of these methods to customize the</span>
    <span class="c1"># data that is rendered for an item.</span>

    <span class="k">def</span> <span class="nf">_get_thumbnail</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the thumbnail for the item.</span>

<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: The item thumbnail data</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtGui.QPixmap`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_role</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">thumbnail</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">thumbnail</span><span class="p">:</span>
            <span class="c1"># Default to empty pixmap</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span>
                <span class="s2">&quot;:/tk-framework-qtwidgets/shotgun_widget/rect_512x400.png&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">thumbnail</span><span class="p">,</span> <span class="s2">&quot;pixmap&quot;</span><span class="p">):</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_icon_to_pixmap</span><span class="p">(</span><span class="n">thumbnail</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">thumbnail</span>

    <span class="k">def</span> <span class="nf">_get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the text data to display. The text data will be the concatentation of the</span>
<span class="sd">        data retrieved from the header_role, subtitle_role and text_role.</span>

<span class="sd">        :param index: The item model index.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param option: The option used for rendering the item. When specified with `rect`,</span>
<span class="sd">                       the header text will be elided, if necessary.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param rect: The bounding rect for the text. When specified with `option`, the</span>
<span class="sd">                     header text will be elided, if necessary.</span>
<span class="sd">        :type rect: :class:`sgtk.platform.qt.QtCore.QRect`</span>

<span class="sd">        :return: A list, where each item represents a text line in the item&#39;s whole text.</span>
<span class="sd">        :rtype: list&lt;str&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_header_text</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
        <span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_display_values_list</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_role</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_header_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_elided</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the header text data to display.</span>

<span class="sd">        This will get the data from the `header_role`</span>
<span class="sd">        and `subtitle_role`, and format them into a single line using an HTML table tag. The</span>
<span class="sd">        table is required to format the subtitle to align right within the same text line as</span>
<span class="sd">        the header text.</span>

<span class="sd">        When the option and rect parameters are provided, the header and subtitle text will</span>
<span class="sd">        be elided, if necessary. Eliding the text must occur here, and not later on in the</span>
<span class="sd">        text processing cycle since the `_elide_text` method cannot handle eliding text inside</span>
<span class="sd">        an HTML table tag very nicely, nor does Qt support eliding text in tables using the</span>
<span class="sd">        HTML/CSS attributes.</span>

<span class="sd">        :param index: The item model index.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param option: The option used for rendering the item. When specified with `rect`,</span>
<span class="sd">                       the header text will be elided, if necessary.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param rect: The bounding rect for the text. When specified with `option`, the</span>
<span class="sd">                     header text will be elided, if necessary.</span>
<span class="sd">        :type rect: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        :param return_elided: Flag indicating whether or not to return a tuple including the</span>
<span class="sd">                              text with a boolean flag indicating if the text was elided or not.</span>
<span class="sd">        :type return_elideD: bool (defualt is False)</span>

<span class="sd">        :return: The formatted header text, as well as a boolean flag indicating if the header</span>
<span class="sd">                 text was elided.</span>
<span class="sd">        :rtype: tuple&lt;str,bool&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">elided</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_display_values_list</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_role</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_display_values_list</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtitle_role</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">subtitle</span><span class="p">:</span>
            <span class="c1"># No title or subtitle found, just return an empty string.</span>
            <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">elided</span><span class="p">)</span> <span class="k">if</span> <span class="n">return_elided</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="n">title_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">subtitle_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">do_elide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elide_header</span> <span class="ow">and</span> <span class="n">option</span> <span class="ow">and</span> <span class="n">rect</span> <span class="ow">and</span> <span class="n">rect</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">do_elide</span><span class="p">:</span>
            <span class="c1"># FIXME for now we&#39;ve just picked an arbitrary value to account for the HTML table offset</span>
            <span class="c1"># to the available width for the text</span>
            <span class="n">target_width</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">-</span> <span class="mi">20</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">target_width</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">subtitle</span><span class="p">:</span>
            <span class="c1"># There is only a title</span>
            <span class="k">if</span> <span class="n">do_elide</span><span class="p">:</span>
                <span class="c1"># Elide the title when the option and rect are provided, and there is text overflow.</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">elided_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_elided_text</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">target_width</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
                <span class="n">elided</span> <span class="o">=</span> <span class="n">title</span> <span class="o">!=</span> <span class="n">elided_title</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">sgutils</span><span class="o">.</span><span class="n">ensure_str</span><span class="p">(</span><span class="n">elided_title</span><span class="p">)</span>

            <span class="n">title_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;left width=&quot;100%&quot;&quot;&gt;</span><span class="si">{text}</span><span class="s1">&lt;/td&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">title</span><span class="p">:</span>
            <span class="c1"># There is only a subtitle</span>
            <span class="k">if</span> <span class="n">do_elide</span><span class="p">:</span>
                <span class="c1"># Elide the title when the option and rect are provided, and there is text overflow.</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">elided_subtitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_elided_text</span><span class="p">(</span>
                    <span class="n">option</span><span class="p">,</span> <span class="n">target_width</span><span class="p">,</span> <span class="n">subtitle</span>
                <span class="p">)</span>
                <span class="n">elided</span> <span class="o">=</span> <span class="n">subtitle</span> <span class="o">!=</span> <span class="n">elided_subtitle</span>
                <span class="n">subtitle</span> <span class="o">=</span> <span class="n">sgutils</span><span class="o">.</span><span class="n">ensure_str</span><span class="p">(</span><span class="n">elided_subtitle</span><span class="p">)</span>

            <span class="n">subtitle_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;right&quot; width=&quot;100%&quot;&gt;</span><span class="si">{text}</span><span class="s1">&lt;/td&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="n">subtitle</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># There is a title and subttile</span>
            <span class="n">title_width_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">subtitle_width_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="k">if</span> <span class="n">do_elide</span><span class="p">:</span>
                <span class="c1"># Elide the title and subttile when the option and rect are provided, and there</span>
                <span class="c1"># is text overflow.</span>
                <span class="n">title_ideal_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html_text_width</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
                <span class="n">subtitle_ideal_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html_text_width</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">subtitle</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">title_ideal_width</span> <span class="o">+</span> <span class="n">subtitle_ideal_width</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">target_width</span><span class="p">:</span>
                    <span class="c1"># There is overflow, title and or subtitle should be elided.</span>
                    <span class="n">title_width_pct</span> <span class="o">=</span> <span class="n">title_ideal_width</span> <span class="o">/</span> <span class="n">target_width</span>
                    <span class="n">subtitle_width_pct</span> <span class="o">=</span> <span class="n">subtitle_ideal_width</span> <span class="o">/</span> <span class="n">target_width</span>

                    <span class="k">if</span> <span class="n">title_width_pct</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="n">subtitle_width_pct</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                        <span class="c1"># Title and subtitle are fighting for space, just split it in half.</span>
                        <span class="n">title_width</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">target_width</span>
                        <span class="n">subtitle_width</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">target_width</span>
                        <span class="n">title_width_str</span> <span class="o">=</span> <span class="s1">&#39;width=&quot;50%&quot;&#39;</span>
                        <span class="n">subtitle_width_str</span> <span class="o">=</span> <span class="s1">&#39;width=&quot;50%&quot;&#39;</span>

                    <span class="k">elif</span> <span class="n">subtitle_width_pct</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
                        <span class="c1"># The subtitle takes up less than half of the space, extend the title to</span>
                        <span class="c1"># the subtitle, and elide it if it still has overflow.</span>
                        <span class="n">title_width_pct</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">subtitle_width_pct</span>
                        <span class="n">title_width</span> <span class="o">=</span> <span class="n">title_width_pct</span> <span class="o">*</span> <span class="n">target_width</span>
                        <span class="n">subtitle_width</span> <span class="o">=</span> <span class="n">subtitle_width_pct</span> <span class="o">*</span> <span class="n">target_width</span>
                        <span class="n">title_width_str</span> <span class="o">=</span> <span class="s1">&#39;width=&quot;</span><span class="si">{}</span><span class="s1">%&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">title_width_pct</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="n">subtitle_width_str</span> <span class="o">=</span> <span class="s1">&#39;width=&quot;</span><span class="si">{}</span><span class="s1">%&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">subtitle_width_pct</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
                        <span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># The title takes up less than half of the space, extend the subtitle to</span>
                        <span class="c1"># the title, and elide it if it still has overflow.</span>
                        <span class="n">title_width</span> <span class="o">=</span> <span class="n">title_width_pct</span> <span class="o">*</span> <span class="n">target_width</span>
                        <span class="n">subtitle_width_pct</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">title_width_pct</span>
                        <span class="n">subtitle_width</span> <span class="o">=</span> <span class="n">subtitle_width_pct</span> <span class="o">*</span> <span class="n">target_width</span>
                        <span class="n">title_width_str</span> <span class="o">=</span> <span class="s1">&#39;width=&quot;</span><span class="si">{}</span><span class="s1">%&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">title_width_pct</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="n">subtitle_width_str</span> <span class="o">=</span> <span class="s1">&#39;width=&quot;</span><span class="si">{}</span><span class="s1">%&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">subtitle_width_pct</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
                        <span class="p">)</span>

                    <span class="n">_</span><span class="p">,</span> <span class="n">elided_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_elided_text</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">title_width</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">elided_subtitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_elided_text</span><span class="p">(</span>
                        <span class="n">option</span><span class="p">,</span> <span class="n">subtitle_width</span><span class="p">,</span> <span class="n">subtitle</span>
                    <span class="p">)</span>
                    <span class="n">elided</span> <span class="o">=</span> <span class="n">title</span> <span class="o">!=</span> <span class="n">elided_title</span> <span class="ow">or</span> <span class="n">subtitle</span> <span class="o">!=</span> <span class="n">elided_subtitle</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="n">sgutils</span><span class="o">.</span><span class="n">ensure_str</span><span class="p">(</span><span class="n">elided_title</span><span class="p">)</span>
                    <span class="n">subtitle</span> <span class="o">=</span> <span class="n">sgutils</span><span class="o">.</span><span class="n">ensure_str</span><span class="p">(</span><span class="n">elided_subtitle</span><span class="p">)</span>

            <span class="n">title_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;left&quot; </span><span class="si">{width}</span><span class="s1">&gt;</span><span class="si">{text}</span><span class="s1">&lt;/td&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">width</span><span class="o">=</span><span class="n">title_width_str</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">title</span>
            <span class="p">)</span>
            <span class="n">subtitle_html</span> <span class="o">=</span> <span class="s1">&#39;&lt;td align=&quot;right&quot; </span><span class="si">{width}</span><span class="s1">&gt;</span><span class="si">{text}</span><span class="s1">&lt;/td&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">width</span><span class="o">=</span><span class="n">subtitle_width_str</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">subtitle</span>
            <span class="p">)</span>

        <span class="c1"># The final formatted text</span>
        <span class="n">formatted_header</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;&lt;table width=&quot;100%&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;</span><span class="si">{border}</span><span class="s1">&quot;&gt;&lt;tr&gt;</span><span class="si">{title_cell}{subtitle_cell}</span><span class="s1">&lt;/tr&gt;&lt;/table&gt;&#39;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">title_cell</span><span class="o">=</span><span class="n">title_html</span><span class="p">,</span>
            <span class="n">subtitle_cell</span><span class="o">=</span><span class="n">subtitle_html</span><span class="p">,</span>
            <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="k">if</span> <span class="n">DEBUG_PAINT</span> <span class="k">else</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">formatted_header</span><span class="p">,</span> <span class="n">elided</span><span class="p">)</span> <span class="k">if</span> <span class="n">return_elided</span> <span class="k">else</span> <span class="n">formatted_header</span>

    <span class="k">def</span> <span class="nf">_get_text_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the QTextDocument that contains the index text data to display. A</span>
<span class="sd">        QTextDocument is used in order to support HTML/rich text, as well as</span>
<span class="sd">        keeping all text inside a single object, so that it is easier to manage</span>
<span class="sd">        the bounding rect and size of the text.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The item model index.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param rect: The bounding rect for the text.</span>
<span class="sd">        :type rect: :class:`sgtk.platform.qt.QtCore.QRect`</span>

<span class="sd">        :return: A tuple containing the text document containing all text for the item and</span>
<span class="sd">                 a flag indicating if any of the text was elided during formatting.</span>
<span class="sd">        :rtype: tuple&lt;:class:`sgtk.platform.qt.QtGui.QTextDocument`, bool&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
        <span class="n">html</span><span class="p">,</span> <span class="n">elided</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_html_text</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span>

        <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_text_document</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rect</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span> <span class="ow">and</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">setTextWidth</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">elided</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retun all of the actions that are valid for this item.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The item model index.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param return_all: Return all actions no matter what.</span>
<span class="sd">        :type return_all: bool</span>
<span class="sd">        :param positions: A list of positions to retrieve actions from.</span>
<span class="sd">        :type positions: list&lt;POSITION&gt;, where POSITION is one of the positions</span>
<span class="sd">                         in `POSITIONS`.</span>

<span class="sd">        :return: All of the valid actions for the item.</span>
<span class="sd">        :rtype: dict, mapping position to list of actions in that position.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_selected</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="n">hover</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_hover</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">POSITIONS</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">positions</span> <span class="ow">and</span> <span class="n">pos</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">result</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">return_all</span>
                    <span class="ow">or</span> <span class="n">action</span><span class="o">.</span><span class="n">show_always</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="n">selected</span> <span class="ow">and</span> <span class="n">action</span><span class="o">.</span><span class="n">show_on_selected</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="n">hover</span> <span class="ow">and</span> <span class="n">action</span><span class="o">.</span><span class="n">show_on_hover</span><span class="p">)</span>
                <span class="p">)</span> <span class="ow">and</span> <span class="n">action</span><span class="o">.</span><span class="n">is_visible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">index</span><span class="p">):</span>
                    <span class="c1"># Action is valid for this item</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_action_and_rects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of tuples of the view item actions and their respective rect.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The item model index.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param return_all: Return all actions no matter what.</span>
<span class="sd">        :type return_all: bool</span>
<span class="sd">        :param positions: A list of positions to retrieve actions from.</span>
<span class="sd">        :type positions: list&lt;POSITION&gt;, where POSITION is one of the positions</span>
<span class="sd">                         in `POSITIONS`.</span>

<span class="sd">        :return: All of the valid actions for the item and their respective bounding rect.</span>
<span class="sd">        :rtype: list&lt;tuple&lt;action, bouding_rect&gt;&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rects</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">item_action_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_actions</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">return_all</span><span class="p">,</span> <span class="n">positions</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">position</span><span class="p">,</span> <span class="n">actions</span> <span class="ow">in</span> <span class="n">item_action_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># The offset will indicate where the next action bounding rect should start.</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span>

            <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
                <span class="c1"># Get the bounding rect for this action</span>
                <span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_action_rect</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
                <span class="c1"># Increment the offset to get the next action boudning rect.</span>
                <span class="n">offset</span> <span class="o">+=</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span>
                <span class="n">rects</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">action</span><span class="p">,</span> <span class="n">rect</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">rects</span>

    <span class="c1">######################################################################################################</span>
    <span class="c1"># Getter methods for bounding rects for item data. Override any of these methods to customize the size</span>
    <span class="c1"># and positioning of the item data; e.g. see the ThumbnailViewItemDelegate that subclasses this base class</span>
    <span class="c1"># to reposition the thumbnail on top and text undernearth (instead of thumbnail left and text to the right.</span>

    <span class="k">def</span> <span class="nf">_get_loading_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the bounding rect for the item&#39;s loading icon. An invalid rect will be</span>
<span class="sd">        returned if the item is not in a loading state. The bounding rect will be positioned</span>
<span class="sd">        to the right in the option rect, and centered vertically.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: The bounding rect for the item&#39;s loading indicator. The rect will be invalid</span>
<span class="sd">                 if there is no loading indicatorto display.</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_role</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">()</span>

        <span class="n">loading</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loading_role</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">loading</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">()</span>

        <span class="n">origin</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
            <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_size</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span>
            <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">icon_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">icon_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_thumbnail_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">thumbnail</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the boudning rect for the item&#39;s thumbnail. The bounding rect will be</span>
<span class="sd">        positioned on the left of the option rect.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: The bounding rect for the item thumbnail.</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">thumbnail</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">thumbnail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_thumbnail</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">thumbnail</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">()</span>

        <span class="n">rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>

        <span class="c1"># Set the thumbnail rect size to the size of the thumbnail, after it has been scaled</span>
        <span class="c1"># to fit to the option rect height.</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_width</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">thumbnail</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_width</span>

        <span class="n">rect</span><span class="o">.</span><span class="n">setSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>

        <span class="c1"># Bump the thumbnail to the left, if there are non-floating actions on the left.</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_actions_left_offset</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">include_margin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_padding</span><span class="o">.</span><span class="n">left</span>
        <span class="p">)</span>
        <span class="n">dx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_padding</span><span class="o">.</span><span class="n">right</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_padding</span><span class="o">.</span><span class="n">top</span>
        <span class="n">dy2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thumbnail_padding</span><span class="o">.</span><span class="n">bottom</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">adjust</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="o">-</span><span class="n">dx2</span><span class="p">,</span> <span class="o">-</span><span class="n">dy2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rect</span>

    <span class="k">def</span> <span class="nf">_get_text_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the bounding rect for the view item text. The rect will be</span>
<span class="sd">        positioned to the right of the thumbnail rect and span the height</span>
<span class="sd">        of option&#39;s rect and span the rest of the option rect width.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: The bounding rect for the item text.</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rect</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>

        <span class="n">thumbnail_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_thumbnail_rect</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="c1"># Just set the rect left edge to the thumbnail rect right edge.</span>
            <span class="n">rect</span><span class="o">.</span><span class="n">setLeft</span><span class="p">(</span><span class="n">thumbnail_rect</span><span class="o">.</span><span class="n">right</span><span class="p">())</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Get the actions offset from the left to adjust the text rect.</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_actions_left_offset</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">include_margin</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">dx</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_padding</span><span class="o">.</span><span class="n">left</span>

        <span class="c1"># Get the actions offset from the right to adjust to the text rect.</span>
        <span class="n">dx2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_actions_right_offset</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">include_margin</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">loading_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_loading_rect</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">loading_rect</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="c1"># Adjust the rect to the left, when displaying the loading indicator.</span>
            <span class="n">dx2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dx2</span><span class="p">,</span> <span class="n">loading_rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span><span class="p">)</span>
        <span class="n">dx2</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_padding</span><span class="o">.</span><span class="n">right</span>

        <span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_padding</span><span class="o">.</span><span class="n">top</span>
        <span class="n">dy2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_padding</span><span class="o">.</span><span class="n">bottom</span>
        <span class="n">rect</span><span class="o">.</span><span class="n">adjust</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="o">-</span><span class="n">dx2</span><span class="p">,</span> <span class="o">-</span><span class="n">dy2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rect</span>

    <span class="k">def</span> <span class="nf">_get_action_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the bounding rect for the view item action.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param position: The position of the action</span>
<span class="sd">        :type position: POSITION enum</span>
<span class="sd">        :param offset: The horizontal offset from the action&#39;s position starting point;</span>
<span class="sd">                       for example, if the position is TOP_RIGHT corner, then the offset</span>
<span class="sd">                       is how far to the left of the rect top right corner, that the action</span>
<span class="sd">                       should be drawn.</span>
<span class="sd">        :param action: The action to get the bounding rect for.</span>
<span class="sd">        :type action: :class:`ViewItemAction`</span>

<span class="sd">        :return: The bounding rect for the item action.</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_data</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;icon&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">icon</span><span class="p">)</span>
        <span class="n">icon_size</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;icon_size&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">action</span><span class="o">.</span><span class="n">icon_size</span>

        <span class="k">if</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;100%&quot;</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Calculate the width of the action</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="s2">&quot;padding_left&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">get_padding_left</span><span class="p">()</span>
            <span class="p">)</span> <span class="o">+</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;padding_right&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">get_padding_right</span><span class="p">())</span>

            <span class="c1"># Extend the width for the text</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">width</span> <span class="o">+=</span> <span class="n">option</span><span class="o">.</span><span class="n">fontMetrics</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span>

            <span class="c1"># Extend the width for the icon</span>
            <span class="k">if</span> <span class="n">icon</span><span class="p">:</span>
                <span class="n">width</span> <span class="o">+=</span> <span class="n">icon_size</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>

            <span class="c1"># Extend the width for by the width hint</span>
            <span class="n">width</span> <span class="o">+=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">width_hint</span><span class="p">())</span>

        <span class="c1"># Set the height to the height of a single text line, plus padding.</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;padding_top&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">get_padding_top</span><span class="p">()</span>
        <span class="p">)</span> <span class="o">+</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;padding_bottom&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">.</span><span class="n">get_padding_bottom</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;adjust_height_to_icon&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">height</span> <span class="o">+=</span> <span class="n">icon_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">+=</span> <span class="n">option</span><span class="o">.</span><span class="n">fontMetrics</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>

        <span class="c1"># Calculate the top left (origin) point, based on the position and offset, to draw the action rect</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLOAT_TOP_LEFT</span><span class="p">):</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLOAT_TOP_RIGHT</span><span class="p">):</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="o">-</span> <span class="n">offset</span> <span class="o">-</span> <span class="n">width</span><span class="p">,</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLOAT_BOTTOM_LEFT</span><span class="p">):</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">-</span> <span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLOAT_BOTTOM_RIGHT</span><span class="p">):</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="o">-</span> <span class="n">offset</span> <span class="o">-</span> <span class="n">width</span><span class="p">,</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">-</span> <span class="n">height</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLOAT_LEFT</span><span class="p">):</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLOAT_RIGHT</span><span class="p">):</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="o">-</span> <span class="n">offset</span> <span class="o">-</span> <span class="n">width</span><span class="p">,</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">position</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CENTER</span><span class="p">:</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Unsupported action position &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_actions_position_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the width of for all actions combined in the given position.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param position: The position of the action</span>
<span class="sd">        :type position: POSITION enum</span>

<span class="sd">        :return: The width of the row of actions in the given position.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">width</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_action_and_rects</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="n">position</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">action_rect</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">+=</span> <span class="n">action_rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span>

        <span class="k">return</span> <span class="n">width</span>

    <span class="k">def</span> <span class="nf">_get_actions_maximum_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the maximum height of all actions.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: The maximum height value of all the actions.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_action_and_rects</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">action_rect</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">action_rect</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">height</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span>

    <span class="k">def</span> <span class="nf">_get_actions_left_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">include_margin</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to get the offset from the left side actions. This will return the</span>
<span class="sd">        horizontal offset from the left of the option rect, where the actions on the left side</span>
<span class="sd">        span to.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param include_margin: Add margin to actions offset.</span>
<span class="sd">        :type include_margin: bool</span>

<span class="sd">        :return: The horizontal offset from the left side of the option rect where the left</span>
<span class="sd">                 side actions end.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_actions_offset</span><span class="p">(</span>
            <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TOP_LEFT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOTTOM_LEFT</span><span class="p">),</span> <span class="n">include_margin</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_actions_right_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">include_margin</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to get the offset from the right side actions. This will return the</span>
<span class="sd">        horizontal offset from the right of the option rect, where the actions on the right side</span>
<span class="sd">        span to.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param include_margin: Add margin to actions offset.</span>
<span class="sd">        :type include_margin: bool</span>

<span class="sd">        :return: The horizontal offset from the right side of the option rect where the right</span>
<span class="sd">                 side actions end.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_actions_offset</span><span class="p">(</span>
            <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TOP_RIGHT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BOTTOM_RIGHT</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_actions_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">include_margin</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to get the offset for the actions in the given positions. This will</span>
<span class="sd">        return the offset from the edge of the option rect, to how far the actions span.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param position: The positions of the actions to calculate the offset for. When more than one</span>
<span class="sd">                         position is provided, the positions should be oriented from the same side (e.g.</span>
<span class="sd">                         top left, bottom left and left).</span>
<span class="sd">        :type position: tuple&lt;POSITION&gt;, where POSITION is one of the position enums</span>
<span class="sd">        :param include_margin: Add margin to actions offset.</span>
<span class="sd">        :type include_margin: bool</span>

<span class="sd">        :return: The offset from the edge of the option rect to how far the actions span.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_actions_position_width</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">offset</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Add the margin from the option rect to the first action.</span>
            <span class="k">if</span> <span class="n">include_margin</span><span class="p">:</span>
                <span class="c1"># Optionally add margin at the end of the actions.</span>
                <span class="n">offset</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_item_margin</span>

        <span class="k">return</span> <span class="n">offset</span>

    <span class="c1">######################################################################################################</span>
    <span class="c1"># Private methods</span>

    <span class="k">def</span> <span class="nf">_hit_box_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if the current cursor position intersects the given rect. If mouse tracking</span>
<span class="sd">        is not enabled on the option widget, this will always return False.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param rect: The rect to check if the cursor is over.</span>
<span class="sd">        :type rect: :class:`sgtk.platform.qt.QtCore.QRect`</span>

<span class="sd">        :return: True if the current cursor position intersects the given rect, else False.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cursor_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cursor_pos</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cursor_pos</span> <span class="ow">and</span> <span class="n">rect</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">cursor_pos</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_action_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the action at the given point `pos`.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param pos: The point to check intersection with action bounding rect.</span>
<span class="sd">        :type pos: :class:`sgtk.platform.qt.QtCore.QPoint`</span>

<span class="sd">        :return: The aciton found at point `pos`.</span>
<span class="sd">        :rtype: :class:`ViewItemAction`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">actions_and_rects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_action_and_rects</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Check for actions in reverse order, since the actions added last will appear in the &quot;front&quot;</span>
        <span class="k">for</span> <span class="n">action</span><span class="p">,</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">actions_and_rects</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">rect</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">action</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_convert_icon_to_pixmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the pixmap converted from the given icon.</span>

<span class="sd">        :param icon: The icon to conver to a pixmap.</span>
<span class="sd">        :type icon: :class:`sgtk.platform.qt.QtGui.QIcon`</span>

<span class="sd">        :return: The pixmap converted from the icon.</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtGui.QPixmap`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">icon</span><span class="o">.</span><span class="n">pixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pixmap_extent</span><span class="p">)</span> <span class="k">if</span> <span class="n">icon</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_update_index_expand_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if an item expand state should change (expand to show all text or collapse</span>
<span class="sd">        to hide text).</span>

<span class="sd">        If the cursor is hovering over the item or the item is selected, and the item</span>
<span class="sd">        text is clipped, then set the index model data to signal to the delegate to</span>
<span class="sd">        expand the item height to show all text.</span>

<span class="sd">        If the cursor is not hovering over the item and the item was expanded to show all text, now collapse the item.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: True if the item exapnd state was changed (either expanded or collapsed).</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_role</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">text_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_text_rect</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">clipped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_text_clipped</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">text_rect</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="n">is_expanded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_role</span><span class="p">)</span>

        <span class="n">state_changed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">hover</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_hover</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_selected</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">hover</span> <span class="ow">or</span> <span class="n">selected</span><span class="p">)</span> <span class="ow">and</span> <span class="n">clipped</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_expanded</span><span class="p">:</span>
            <span class="c1"># Cursor is hovering over an item, or item is selected, and its text is vertically</span>
            <span class="c1"># clipped. Set the index data flag to expand the row height.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toggle_expand_item</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">state_changed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">hover</span> <span class="ow">or</span> <span class="n">selected</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">clipped</span> <span class="ow">and</span> <span class="n">is_expanded</span><span class="p">:</span>
            <span class="c1"># This item was expanded on hover or due to selection, but now is deselected or the</span>
            <span class="c1"># cursor has moved off of it. Update the index data to collapse the item height.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_toggle_expand_item</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">state_changed</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">state_changed</span>

    <span class="k">def</span> <span class="nf">_toggle_expand_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">expand_flag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expand the item to display all text. To expand the item, the item index data</span>
<span class="sd">        will be set to indicate that the item should expand to display all of its</span>
<span class="sd">        text data, then a `sizeHintChanged` signal is emitted to re-render the item.</span>

<span class="sd">        :param index: The model index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_role</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">expand_flag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">expand_flag</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_role</span><span class="p">)</span>

        <span class="n">index</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">expand_flag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_role</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizeHintChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_is_expanded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if the item is currently expanded to show all text.</span>

<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: True if the expand action is currently shown, else False.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_role</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_role</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_text_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new QTextDocument object. Whenever a QTextDocument is required, this</span>
<span class="sd">        method should be used to create the object to ensure all QTextDocuments used</span>
<span class="sd">        for the item text are consistent (e.g. font, document margin, etc.).</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>

<span class="sd">        :return: The created QTextDocument object.</span>
<span class="sd">        :rtype: :class:`sgtk.platform.qt.QtGui.QTextDocument`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">doc</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QTextDocument</span><span class="p">()</span>
        <span class="c1"># Use the font set on the delegate. If not set, default to theoption font is initialized</span>
        <span class="c1"># in the QStyledItemDelegate `initStyleOption` method, the font is set based on the model</span>
        <span class="c1"># index data for the QtCore.Qt.FontRole.</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">setDefaultFont</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">font</span> <span class="ow">or</span> <span class="n">option</span><span class="o">.</span><span class="n">font</span><span class="p">)</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">setDefaultStyleSheet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">document_style_sheet</span><span class="p">)</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">setDocumentMargin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_document_margin</span><span class="p">)</span>

        <span class="n">text_option</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QTextOption</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">defaultTextOption</span><span class="p">())</span>
        <span class="n">text_option</span><span class="o">.</span><span class="n">setWrapMode</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTextOption</span><span class="o">.</span><span class="n">WordWrap</span><span class="p">)</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">setDefaultTextOption</span><span class="p">(</span><span class="n">text_option</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>

    <span class="k">def</span> <span class="nf">_get_visible_lines_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">line_text</span><span class="o">=</span><span class="s2">&quot;placeholder&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the height based on the number of visible lines. A placeholder text is used</span>
<span class="sd">        to calculate the height per line.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param line_text: The placehoder text used to calculate the line height. The specific</span>
<span class="sd">                          text should not affect the overall height.</span>
<span class="sd">        :type line_text: str</span>

<span class="sd">        :return: The height calculated from the number of visible lines that are displayed.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_lines</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="c1"># A QTextDocument is created to calculate an accurate height to what would be rendered.</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_text_document</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>

        <span class="c1"># Create an HTML text string that is the number of `visible_lines`</span>
        <span class="n">html_lines</span> <span class="o">=</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">line_text</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_lines</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">html_lines</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_html_text_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the width of the rendered HTML text.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param text: The text to check for overflow.</span>
<span class="sd">        :type text: str</span>

<span class="sd">        :return: The width of the text when rendered.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># To calculate the width of the HTML text, a QTextDocument is reuired to ensure</span>
        <span class="c1"># that any formatting on the text is applied when getting the text width.</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_text_document</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">idealWidth</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_is_text_clipped</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">text_lines</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if the displayed text was vertically clipped to fit</span>
<span class="sd">        to the view item bounding rect.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param rect: The text bounding rect</span>
<span class="sd">        :type rect: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        :param text_lines: The text to check if it fits inside the given rect,</span>
<span class="sd">                           if not, it should be clipped.</span>
<span class="sd">        :type text_line: list&lt;str&gt;</span>

<span class="sd">        :return: True if the text has overflow and should be clipped, else False.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">line_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">text_doc_margins</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_document_margin</span>
        <span class="c1"># The maximum height for the text</span>
        <span class="n">available_height</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="n">text_doc_margins</span>

        <span class="c1"># Go through the text lines one by one, adding up each line height and</span>
        <span class="c1"># returning True immediately if the text goes beyond the rect height.</span>
        <span class="k">while</span> <span class="n">line_num</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_lines</span><span class="p">):</span>  <span class="c1"># and height &lt; rect.height():</span>
            <span class="c1"># while line_num &lt; len(text_lines) and height &lt; rect.height():</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">text_lines</span><span class="p">[</span><span class="n">line_num</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">line_num</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># Split the line if there are any HTML line breaks in the text.</span>
            <span class="n">html_text_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_html_lines</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">html_text_lines</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># No need to elide the text, the text line height will remain the same.</span>
                <span class="n">text_line_doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_text_document</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
                <span class="n">text_line_doc</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

                <span class="c1"># Append the text line height and substract the text doc margin since when the text</span>
                <span class="c1"># is actually rendered, it will be rendered in one text document, instead of a</span>
                <span class="c1"># text document per line (text document in this case needs to be created per line</span>
                <span class="c1"># to calculate the individual line heights).</span>
                <span class="n">height</span> <span class="o">+=</span> <span class="n">text_line_doc</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="n">text_doc_margins</span>
                <span class="k">if</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="n">available_height</span><span class="p">:</span>
                    <span class="c1"># Text exceeds the maximum height, indicate the text should be clipped.</span>
                    <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># Text fits within the available rect height.</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_format_html_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">text_lines</span><span class="p">,</span> <span class="n">clip</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format the HTML text.</span>

<span class="sd">        :param option: The option used for rendering the item.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param index: The index of the item.</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>
<span class="sd">        :param rect: The text bounding rect</span>
<span class="sd">        :type rect: :class:`sgtk.platform.qt.QtCore.QRect`</span>
<span class="sd">        :param text_lines: The text to check if it fits inside the given rect,</span>
<span class="sd">                           if not, it should be clipped.</span>
<span class="sd">        :type text_line: list&lt;str&gt;</span>
<span class="sd">        :param clip: True if the text should be clipped when there is overflow, else False</span>
<span class="sd">                     will return all text even if there is overflow.</span>

<span class="sd">        :return: A tuple containging the html formatted text and a flag indicating if the</span>
<span class="sd">                 any of the text was elided during formatting.</span>
<span class="sd">        :rtype: tuple&lt;str, bool&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">html_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">line_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">elided</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">clip</span><span class="p">:</span>
            <span class="c1"># Keep track of the height when the text will be clipped if exceeds the maximum height.</span>
            <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">margin_offset</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_document_margin</span>
            <span class="c1"># The maximum allowed text height.</span>
            <span class="n">available_height</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="n">margin_offset</span>

        <span class="c1"># Format text line by line</span>
        <span class="c1"># Stop if clipping enabled and the text height exceeds the maximum</span>
        <span class="c1"># Stop if `visible_lines` property is set and the line count exceeds the number of visible lines set and the</span>
        <span class="c1">#   item for this index is not expanded (e.g. do not clip if item is set to be expanded to show all text)</span>
        <span class="k">while</span> <span class="p">(</span>
            <span class="n">line_num</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_lines</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">clip</span> <span class="ow">or</span> <span class="n">height</span> <span class="o">&lt;</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
            <span class="ow">and</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">visible_lines</span> <span class="o">&lt;</span> <span class="mi">0</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_expanded</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">line_count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_lines</span>
            <span class="p">)</span>
        <span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">text_lines</span><span class="p">[</span><span class="n">line_num</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">line_num</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># If an individual line has line breaks, split out those lines and process</span>
            <span class="c1"># them individually.</span>
            <span class="n">html_text_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_html_lines</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">html_text_lines</span><span class="p">:</span>
                <span class="c1"># Strip any leading or trailing whitespace.</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">text</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_expanded</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_lines</span> <span class="o">&gt;=</span> <span class="mi">0</span>
                    <span class="ow">and</span> <span class="n">line_count</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible_lines</span>
                <span class="p">):</span>
                    <span class="c1"># Exceeded the number of visible lines. Stop formatting.</span>
                    <span class="k">break</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elide_text</span><span class="p">:</span>
                    <span class="c1"># Because the text is allowed to be HTML formatted, in order to elide an</span>
                    <span class="c1"># individual line (if necessary), the text must be rendered using a</span>
                    <span class="c1"># QTextDocument which then the document can be used to determine if the</span>
                    <span class="c1"># formatted text exceeds the maximum width. A side effect of eliding the</span>
                    <span class="c1"># text using a QTextDocument is that the resulting elided text will be</span>
                    <span class="c1"># a full HTML doc string.</span>
                    <span class="n">doc</span><span class="p">,</span> <span class="n">elided_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_elided_text</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">text</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Even though the text is not elided, still need to get the text document</span>
                    <span class="c1"># to measure the text height for clipping</span>
                    <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_text_document</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
                    <span class="n">doc</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                    <span class="n">elided_text</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="n">clip</span><span class="p">:</span>
                    <span class="n">height</span> <span class="o">+=</span> <span class="n">doc</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="n">margin_offset</span>
                    <span class="k">if</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="n">available_height</span> <span class="ow">and</span> <span class="n">clip</span><span class="p">:</span>
                        <span class="c1"># Text height exceeded the maximum. Stop formatting.</span>
                        <span class="k">break</span>

                <span class="k">if</span> <span class="n">elided_text</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">text</span> <span class="o">==</span> <span class="n">elided_text</span><span class="p">:</span>
                    <span class="c1"># Text did not change, just add the text and a line break.</span>
                    <span class="n">html_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                    <span class="n">html_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Text was elided. Elided text is in the format of a full HTML document,</span>
                    <span class="c1"># which includes line breaks before and after, so if there</span>
                    <span class="c1"># was a line break added before this line, remove it. Do not explicitly</span>
                    <span class="c1"># add a # new line break after the elided text.</span>
                    <span class="k">if</span> <span class="n">html_lines</span> <span class="ow">and</span> <span class="n">html_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">:</span>
                        <span class="n">html_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">elided_text</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">html_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elided_text</span><span class="p">)</span>

                    <span class="n">elided</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="n">line_count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Remove trailing new line</span>
        <span class="k">if</span> <span class="n">html_lines</span> <span class="ow">and</span> <span class="n">html_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">:</span>
            <span class="n">html_lines</span> <span class="o">=</span> <span class="n">html_lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Return a single string, lines are separated by HTML line break tags.</span>
        <span class="n">html_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">sgutils</span><span class="o">.</span><span class="n">ensure_str</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">html_lines</span><span class="p">]</span>
        <span class="n">formatted_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">html_lines</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">formatted_str</span><span class="p">,</span> <span class="n">elided</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_elided_text</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">target_width</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">elide_mode</span><span class="o">=</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ElideRight</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Elide the text if the width exceeds the given `target_width`. This slightly tweaks</span>
<span class="sd">        the implementation from :class:`ElidedLabel` method `_elide_text`.</span>

<span class="sd">        :param option: The view option the text is rendered in.</span>
<span class="sd">        :type option: :class:`sgtk.platform.qt.QtGui.QStyleOptionViewItem`</span>
<span class="sd">        :param target_width: The desired width for the text</span>
<span class="sd">        :type target_width: int</span>
<span class="sd">        :param text: The text to elide</span>
<span class="sd">        :type text: str</span>
<span class="sd">        :param elide_mode: The elide mode to use</span>
<span class="sd">        :type elide_mode: :class:`sgtk.platform.qt.Qtcore.Qt.TextElideMode`</span>

<span class="sd">        :returns: The QTextDocument used to elide the text and the elided text. If the text</span>
<span class="sd">                  is not elided, the original text is returned. Note that if the text is</span>
<span class="sd">                  elided, the elided text is the value returned by doc.toHtml(), which will</span>
<span class="sd">                  return a string in the form of a full HTML document.</span>
<span class="sd">        :rtype: tuple&lt;:class:`sgkt.platform.qt.QTextDocument`, str&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Use a QTextDocument to measure html/rich text width</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_text_document</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">target_width</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;table&quot;</span><span class="p">):</span>
            <span class="c1"># Just return the doc and text unaltered if the target_width is invalid or the text contains</span>
            <span class="c1"># unsupported HTML tags.</span>
            <span class="c1"># NOTE: Text wrapped in HTML table tag is not supported. See `get_header_text` as an example</span>
            <span class="c1"># to eliding table cell text.</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="n">line_width</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">idealWidth</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line_width</span> <span class="o">&lt;=</span> <span class="n">target_width</span><span class="p">:</span>
            <span class="c1"># Nothing more to do, the text fits within the target_width</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="c1"># Depending on the elide mode, insert ellipses in the correct place</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QTextCursor</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="n">ellipses</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">elide_mode</span> <span class="o">!=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ElideNone</span><span class="p">:</span>
            <span class="c1"># Add the ellipses in the correct place</span>
            <span class="n">ellipses</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span>

            <span class="k">if</span> <span class="n">elide_mode</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ElideLeft</span><span class="p">:</span>
                <span class="n">cursor</span><span class="o">.</span><span class="n">setPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">elide_mode</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ElideRight</span><span class="p">:</span>
                <span class="n">char_count</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">characterCount</span><span class="p">()</span>
                <span class="n">cursor</span><span class="o">.</span><span class="n">setPosition</span><span class="p">(</span><span class="n">char_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">insertText</span><span class="p">(</span><span class="n">ellipses</span><span class="p">)</span>

        <span class="n">ellipses_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ellipses</span><span class="p">)</span>

        <span class="c1"># Remove characters until the text fits within the target width</span>
        <span class="k">while</span> <span class="n">line_width</span> <span class="o">&gt;</span> <span class="n">target_width</span><span class="p">:</span>
            <span class="n">start_line_width</span> <span class="o">=</span> <span class="n">line_width</span>

            <span class="c1"># If string is less than the ellipses length then just return an empty string</span>
            <span class="n">char_count</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">characterCount</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">char_count</span> <span class="o">&lt;=</span> <span class="n">ellipses_len</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;&quot;</span>

            <span class="c1"># Calculate the number of characters to remove - should always remove at least 1 to be sure the text gets shorter</span>
            <span class="n">line_width</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">idealWidth</span><span class="p">()</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">target_width</span> <span class="o">/</span> <span class="n">line_width</span>
            <span class="c1"># Play it safe and remove a couple less than the calculated amount</span>
            <span class="n">chars_to_delete</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">char_count</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">char_count</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

            <span class="c1"># Remove the characters:</span>
            <span class="k">if</span> <span class="n">elide_mode</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ElideLeft</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">ellipses_len</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">chars_to_delete</span> <span class="o">+</span> <span class="n">ellipses_len</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Default is to elide right</span>
                <span class="n">start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">char_count</span> <span class="o">-</span> <span class="n">chars_to_delete</span> <span class="o">-</span> <span class="n">ellipses_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">char_count</span> <span class="o">-</span> <span class="n">ellipses_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">cursor</span><span class="o">.</span><span class="n">setPosition</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">setPosition</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QTextCursor</span><span class="o">.</span><span class="n">KeepAnchor</span><span class="p">)</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">removeSelectedText</span><span class="p">()</span>

            <span class="n">line_width</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">idealWidth</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line_width</span> <span class="o">==</span> <span class="n">start_line_width</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">doc</span><span class="o">.</span><span class="n">toHtml</span><span class="p">())</span></div>


<span class="k">class</span> <span class="nc">ViewItemAction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class object to handle rendering item actions in the :class:`ViewItemDelegate`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Enum to describe the type of view item action.</span>
    <span class="p">(</span>
        <span class="n">TYPE_PUSH_BUTTON</span><span class="p">,</span>
        <span class="n">TYPE_RADIO_BUTTON</span><span class="p">,</span>
        <span class="n">TYPE_CHECK_BOX</span><span class="p">,</span>
        <span class="n">TYPE_PROGRESS_BAR</span><span class="p">,</span>
        <span class="n">TYPE_ICON</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># Default widths for action types</span>
    <span class="n">DEFAULT_WIDTHS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">TYPE_RADIO_BUTTON</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="n">TYPE_PROGRESS_BAR</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># The action attributes that will be used to initialize the object.</span>
    <span class="n">_ATTRIBUTES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="c1"># The text/label displayed for the action button</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">TYPE_PUSH_BUTTON</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># The action button option style features</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;features&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># The icon displayed for the action button</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;icon&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># The size for the action icon</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;icon_size&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Padding applied around the action button</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;padding&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;padding_top&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;padding_right&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;padding_bottom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;padding_left&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Text to display in a tooltip when the cursor is over the action</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;tooltip&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Specific palette brushes to set for the action button. Palette brushes</span>
            <span class="c1"># dict maps brush type to list of brush items, which should be in the</span>
            <span class="c1"># format of a tuple, e.g.:</span>
            <span class="c1">#   (QPalette.ColorGroup, QPalette.ColorRole, QBrush)</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;palette_brushes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Flag indicating if this action should always been shown, no matter what the state is</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;show_always&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Flag indicating to show the action when the action&#39;s item is selected</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;show_on_selected&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Flag indicating to show the action when the action&#39;s item is hovered over</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;show_on_hover&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Callback function used to return data to display the action for the speicifc index.</span>
            <span class="c1"># The parent param is the parent of the delegate requesting the data.</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;get_data&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="p">{},</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Callback function used to execute some operations when the action is &quot;clicked&quot;</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;callback&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Set a fixed width for the action</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># Flag indicating to draw the action or not, but maintains space for the action regardless of</span>
            <span class="c1"># if it is drawn or not (e.g. this action acts as a spacer, which may be desirable to keep</span>
            <span class="c1"># actions lined up in each row of the delegate&#39;s view)</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;placeholder&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="c1"># The Qt.ItemDataRole to use set/get the action&#39;s check state data. This is usefule if an</span>
            <span class="c1"># item has more than one checkable action</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;check_state_role&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">CheckStateRole</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor. Use the data passed to initialize the object.</span>

<span class="sd">        :param data: The data to initialize the action with.</span>
<span class="sd">        :type data: dict, see `_ATTRIBUTES` for supported key-values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ATTRIBUTES</span><span class="p">:</span>
            <span class="n">required</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;required&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">attr_name</span> <span class="o">=</span> <span class="n">attribute</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">required</span> <span class="ow">and</span> <span class="n">attr_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Required data not provided on </span><span class="si">{}</span><span class="s2"> init&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">data</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">else</span> <span class="n">attribute</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">checkable_types</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a tuple icontaining the types that can be checked.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">TYPE_CHECK_BOX</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">TYPE_RADIO_BUTTON</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">icon</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the action icon. If a string is given, create the icon from the string. The icon will be</span>
<span class="sd">        set to None if an invalid value provided.</span>

<span class="sd">        :param icon: The action icon</span>
<span class="sd">        :type icon: str | :class:`sgkt.platform.qt.QtGui.QIcon`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">icon</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">icon</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">icon</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">icon</span> <span class="o">=</span> <span class="n">icon</span>

    <span class="k">def</span> <span class="nf">is_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to check if the action is visible for the given index.</span>

<span class="sd">        :param parent: The parent of deleaget who requested the data.</span>
<span class="sd">        :type parent: :class:`sgtk.platform.qt.QtGui.QAbstractItemView`</span>
<span class="sd">        :param index: The model item index</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: True if the action is visible for the index.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to get the state of the action for the given index.</span>

<span class="sd">        :param parent: The parent of delegate who requested the data.</span>
<span class="sd">        :type parent: :class:`sgtk.platform.qt.QtGui.QAbstractItemView`</span>
<span class="sd">        :param index: The model item index</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: The action state.</span>
<span class="sd">        :rtype: QState</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_Active</span> <span class="o">|</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_Enabled</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to get the current action name for the given index. The</span>
<span class="sd">        particular index may want to override the default action name.</span>

<span class="sd">        :param parent: The parent of deleaget who requested the data.</span>
<span class="sd">        :type parent: :class:`sgtk.platform.qt.QtGui.QAbstractItemView`</span>
<span class="sd">        :param index: The model item index</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: The name for the action at the given index</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_clickable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        An action is clickable if:</span>
<span class="sd">            1. It is visible and not a placeholder</span>
<span class="sd">            2. It is a checkbox or radio action, or has a callback</span>
<span class="sd">            3. It is in an enabled state</span>

<span class="sd">        :param parent: The parent of deleaget who requested the data.</span>
<span class="sd">        :type parent: :class:`sgtk.platform.qt.QtGui.QAbstractItemView`</span>
<span class="sd">        :param index: The model item index</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: True if the action is clickable, else False.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">index_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="n">index_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkable_types</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QStyle</span><span class="o">.</span><span class="n">State_Enabled</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">width_hint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the suggested width to display the action.</span>

<span class="sd">        :param parent: The parent of deleaget who requested the data.</span>
<span class="sd">        :type parent: :class:`sgtk.platform.qt.QtGui.QAbstractItemView`</span>
<span class="sd">        :param index: The model item index</span>
<span class="sd">        :type index: :class:`sgtk.platform.qt.QtCore.QModelIndex`</span>

<span class="sd">        :return: The width hint for action.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_WIDTHS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_padding_top</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the padding for above the action.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding_top</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>

    <span class="k">def</span> <span class="nf">get_padding_right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the padding to the right of the action.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding_right</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>

    <span class="k">def</span> <span class="nf">get_padding_bottom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the padding for below the action.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding_bottom</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>

    <span class="k">def</span> <span class="nf">get_padding_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the padding to the left of the action.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding_left</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Autodesk.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

  <script type="text/javascript">
    window.wafCCPAForceShow = true;
    (function(a,b,c,d){
      a='https://tags.tiqcdn.com/utag/autodesk/micro-basic/prod/utag.js';
      b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;
      a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a);
    })();
  </script>


</body>
</html>